<!DOCTYPE html>
<html lang="en-US" prefix="og: https://ogp.me/ns#">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="/xmlrpc.php">

<title>Into the Borg â€“ SSRF inside Google production network | OpnSec</title>
<meta name='robots' content='max-image-preview:large'/>

<!-- All In One SEO Pack 3.6.2[280,361] -->
<script type="application/ld+json" class="aioseop-schema">{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"/#organization","url":"/","name":"OpnSec","sameAs":[]},{"@type":"WebSite","@id":"/#website","url":"/","name":"OpnSec","publisher":{"@id":"/#organization"},"potentialAction":{"@type":"SearchAction","target":"/?s={search_term_string}","query-input":"required name=search_term_string"}},{"@type":"WebPage","@id":"/2018/07/into-the-borg-ssrf-inside-google-production-network/#webpage","url":"/2018/07/into-the-borg-ssrf-inside-google-production-network/","inLanguage":"en-US","name":"Into the Borg - SSRF inside Google production network","isPartOf":{"@id":"/#website"},"breadcrumb":{"@id":"/2018/07/into-the-borg-ssrf-inside-google-production-network/#breadcrumblist"},"datePublished":"2018-07-20T14:51:40+00:00","dateModified":"2021-07-30T20:07:09+00:00"},{"@type":"Article","@id":"/2018/07/into-the-borg-ssrf-inside-google-production-network/#article","isPartOf":{"@id":"/2018/07/into-the-borg-ssrf-inside-google-production-network/#webpage"},"author":{"@id":"/author/opnsec/#author"},"headline":"Into the Borg &#8211; SSRF inside Google production network","datePublished":"2018-07-20T14:51:40+00:00","dateModified":"2021-07-30T20:07:09+00:00","commentCount":7,"mainEntityOfPage":{"@id":"/2018/07/into-the-borg-ssrf-inside-google-production-network/#webpage"},"publisher":{"@id":"/#organization"},"articleSection":"Google, Borg, Google, Kubernetes, SSRF"},{"@type":"Person","@id":"/author/opnsec/#author","name":"Engue Gillier","sameAs":[],"image":{"@type":"ImageObject","@id":"/#personlogo","url":"https://secure.gravatar.com/avatar/ad925bdf7fba0f9608daa94bb809531a?s=96&d=mm&r=g","width":96,"height":96,"caption":"Engue Gillier"}},{"@type":"BreadcrumbList","@id":"/2018/07/into-the-borg-ssrf-inside-google-production-network/#breadcrumblist","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"/","url":"/","name":"OpnSec"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"/2018/07/into-the-borg-ssrf-inside-google-production-network/","url":"/2018/07/into-the-borg-ssrf-inside-google-production-network/","name":"Into the Borg - SSRF inside Google production network"}}]}]}</script>
<link rel="canonical" href="/2018/07/into-the-borg-ssrf-inside-google-production-network/"/>
<meta property="og:type" content="article"/>
<meta property="og:title" content="Into the Borg â€“ SSRF inside Google production network | OpnSec"/>
<meta property="og:description" content="Intro - Testing Google Sites and Google Caja In March 2018, I reported an XSS in Google Caja, a tool to securely embed arbitrary html/javascript in a webpage. In May 2018, after the XSS was fixed, I r"/>
<meta property="og:url" content="/2018/07/into-the-borg-ssrf-inside-google-production-network/"/>
<meta property="og:site_name" content="OpnSec"/>
<meta property="og:image" content="/wp-content/uploads/2018/07/borg2-1024x498.png"/>
<meta property="article:published_time" content="2018-07-20T14:51:40Z"/>
<meta property="article:modified_time" content="2021-07-30T20:07:09Z"/>
<meta property="og:image:secure_url" content="/wp-content/uploads/2018/07/borg2-1024x498.png"/>
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:site" content="@opnsec.com"/>
<meta name="twitter:title" content="Into the Borg â€“ SSRF inside Google production network | OpnSec"/>
<meta name="twitter:description" content="Intro - Testing Google Sites and Google Caja In March 2018, I reported an XSS in Google Caja, a tool to securely embed arbitrary html/javascript in a webpage. In May 2018, after the XSS was fixed, I r"/>
<meta name="twitter:image" content="/wp-content/uploads/2018/07/borg2-1024x498.png"/>
<!-- All In One SEO Pack -->
<link rel='dns-prefetch' href='//fonts.googleapis.com'/>
<link rel='dns-prefetch' href='//s.w.org'/>
<link rel="alternate" type="application/rss+xml" title="OpnSec &raquo; Feed" href="/feed/"/>
<link rel="alternate" type="application/rss+xml" title="OpnSec &raquo; Comments Feed" href="/comments/feed/"/>
<link rel="alternate" type="application/rss+xml" title="OpnSec &raquo; Into the Borg &#8211; SSRF inside Google production network Comments Feed" href="/2018/07/into-the-borg-ssrf-inside-google-production-network/feed/"/>
<!-- This site uses the Google Analytics by ExactMetrics plugin v6.0.2 - Using Analytics tracking - https://www.exactmetrics.com/ -->
<script type="text/javascript" data-cfasync="false">var em_version='6.0.2';var em_track_user=true;var em_no_track_reason='';var disableStr='ga-disable-UA-108066765-1';function __gaTrackerIsOptedOut(){return document.cookie.indexOf(disableStr+'=true')>-1;}if(__gaTrackerIsOptedOut()){window[disableStr]=true;}function __gaTrackerOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';window[disableStr]=true;}if('undefined'===typeof gaOptout){function gaOptout(){__gaTrackerOptout();}}if(em_track_user){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','__gaTracker');window.ga=__gaTracker;__gaTracker('create','UA-108066765-1','auto');__gaTracker('set','forceSSL',true);__gaTracker('send','pageview');__gaTracker(function(){window.ga=__gaTracker;});}else{console.log("");(function(){var noopfn=function(){return null;};var noopnullfn=function(){return null;};var Tracker=function(){return null;};var p=Tracker.prototype;p.get=noopfn;p.set=noopfn;p.send=noopfn;var __gaTracker=function(){var len=arguments.length;if(len===0){return;}var f=arguments[len-1];if(typeof f!=='object'||f===null||typeof f.hitCallback!=='function'){console.log('Not running function __gaTracker('+arguments[0]+" ....) because you are not being tracked. "+em_no_track_reason);return;}try{f.hitCallback();}catch(ex){}};__gaTracker.create=function(){return new Tracker();};__gaTracker.getByName=noopnullfn;__gaTracker.getAll=function(){return[];};__gaTracker.remove=noopfn;window['__gaTracker']=__gaTracker;window.ga=__gaTracker;})();}</script>
<!-- / Google Analytics by ExactMetrics -->
<script type="text/javascript">window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/opnsec.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.0.11"}};!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode,e=(p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0),i.toDataURL());return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([129777,127995,8205,129778,127999],[129777,127995,8203,129778,127999])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(e=t.source||{}).concatemoji?c(e.concatemoji):e.wpemoji&&e.twemoji&&(c(e.twemoji),c(e.wpemoji)))}(window,document,window._wpemojiSettings);</script>
<style type="text/css">img.wp-smiley,img.emoji{display:inline!important;border:none!important;box-shadow:none!important;height:1em!important;width:1em!important;margin:0 .07em!important;vertical-align:-.1em!important;background:none!important;padding:0!important}</style>
	<link rel='stylesheet' id='wp-block-library-css' href='/wp-includes/css/dist/block-library/style.min.css?ver=6.0.11' type='text/css' media='all'/>
<style id='wp-block-library-inline-css' type='text/css'>.has-text-align-justify{text-align:justify}</style>
<style id='global-styles-inline-css' type='text/css'>body{--wp--preset--color--black:#000;--wp--preset--color--cyan-bluish-gray:#abb8c3;--wp--preset--color--white:#fff;--wp--preset--color--pale-pink:#f78da7;--wp--preset--color--vivid-red:#cf2e2e;--wp--preset--color--luminous-vivid-orange:#ff6900;--wp--preset--color--luminous-vivid-amber:#fcb900;--wp--preset--color--light-green-cyan:#7bdcb5;--wp--preset--color--vivid-green-cyan:#00d084;--wp--preset--color--pale-cyan-blue:#8ed1fc;--wp--preset--color--vivid-cyan-blue:#0693e3;--wp--preset--color--vivid-purple:#9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple:linear-gradient(135deg,rgba(6,147,227,1) 0%,#9b51e0 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan:linear-gradient(135deg,#7adcb4 0%,#00d082 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange:linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red:linear-gradient(135deg,rgba(255,105,0,1) 0%,#cf2e2e 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray:linear-gradient(135deg,#eee 0%,#a9b8c3 100%);--wp--preset--gradient--cool-to-warm-spectrum:linear-gradient(135deg,#4aeadc 0%,#9778d1 20%,#cf2aba 40%,#ee2c82 60%,#fb6962 80%,#fef84c 100%);--wp--preset--gradient--blush-light-purple:linear-gradient(135deg,#ffceec 0%,#9896f0 100%);--wp--preset--gradient--blush-bordeaux:linear-gradient(135deg,#fecda5 0%,#fe2d2d 50%,#6b003e 100%);--wp--preset--gradient--luminous-dusk:linear-gradient(135deg,#ffcb70 0%,#c751c0 50%,#4158d0 100%);--wp--preset--gradient--pale-ocean:linear-gradient(135deg,#fff5cb 0%,#b6e3d4 50%,#33a7b5 100%);--wp--preset--gradient--electric-grass:linear-gradient(135deg,#caf880 0%,#71ce7e 100%);--wp--preset--gradient--midnight:linear-gradient(135deg,#020381 0%,#2874fc 100%);--wp--preset--duotone--dark-grayscale:url(#wp-duotone-dark-grayscale);--wp--preset--duotone--grayscale:url(#wp-duotone-grayscale);--wp--preset--duotone--purple-yellow:url(#wp-duotone-purple-yellow);--wp--preset--duotone--blue-red:url(#wp-duotone-blue-red);--wp--preset--duotone--midnight:url(#wp-duotone-midnight);--wp--preset--duotone--magenta-yellow:url(#wp-duotone-magenta-yellow);--wp--preset--duotone--purple-green:url(#wp-duotone-purple-green);--wp--preset--duotone--blue-orange:url(#wp-duotone-blue-orange);--wp--preset--font-size--small:13px;--wp--preset--font-size--medium:20px;--wp--preset--font-size--large:36px;--wp--preset--font-size--x-large:42px}.has-black-color{color:var(--wp--preset--color--black)!important}.has-cyan-bluish-gray-color{color:var(--wp--preset--color--cyan-bluish-gray)!important}.has-white-color{color:var(--wp--preset--color--white)!important}.has-pale-pink-color{color:var(--wp--preset--color--pale-pink)!important}.has-vivid-red-color{color:var(--wp--preset--color--vivid-red)!important}.has-luminous-vivid-orange-color{color:var(--wp--preset--color--luminous-vivid-orange)!important}.has-luminous-vivid-amber-color{color:var(--wp--preset--color--luminous-vivid-amber)!important}.has-light-green-cyan-color{color:var(--wp--preset--color--light-green-cyan)!important}.has-vivid-green-cyan-color{color:var(--wp--preset--color--vivid-green-cyan)!important}.has-pale-cyan-blue-color{color:var(--wp--preset--color--pale-cyan-blue)!important}.has-vivid-cyan-blue-color{color:var(--wp--preset--color--vivid-cyan-blue)!important}.has-vivid-purple-color{color:var(--wp--preset--color--vivid-purple)!important}.has-black-background-color{background-color:var(--wp--preset--color--black)!important}.has-cyan-bluish-gray-background-color{background-color:var(--wp--preset--color--cyan-bluish-gray)!important}.has-white-background-color{background-color:var(--wp--preset--color--white)!important}.has-pale-pink-background-color{background-color:var(--wp--preset--color--pale-pink)!important}.has-vivid-red-background-color{background-color:var(--wp--preset--color--vivid-red)!important}.has-luminous-vivid-orange-background-color{background-color:var(--wp--preset--color--luminous-vivid-orange)!important}.has-luminous-vivid-amber-background-color{background-color:var(--wp--preset--color--luminous-vivid-amber)!important}.has-light-green-cyan-background-color{background-color:var(--wp--preset--color--light-green-cyan)!important}.has-vivid-green-cyan-background-color{background-color:var(--wp--preset--color--vivid-green-cyan)!important}.has-pale-cyan-blue-background-color{background-color:var(--wp--preset--color--pale-cyan-blue)!important}.has-vivid-cyan-blue-background-color{background-color:var(--wp--preset--color--vivid-cyan-blue)!important}.has-vivid-purple-background-color{background-color:var(--wp--preset--color--vivid-purple)!important}.has-black-border-color{border-color:var(--wp--preset--color--black)!important}.has-cyan-bluish-gray-border-color{border-color:var(--wp--preset--color--cyan-bluish-gray)!important}.has-white-border-color{border-color:var(--wp--preset--color--white)!important}.has-pale-pink-border-color{border-color:var(--wp--preset--color--pale-pink)!important}.has-vivid-red-border-color{border-color:var(--wp--preset--color--vivid-red)!important}.has-luminous-vivid-orange-border-color{border-color:var(--wp--preset--color--luminous-vivid-orange)!important}.has-luminous-vivid-amber-border-color{border-color:var(--wp--preset--color--luminous-vivid-amber)!important}.has-light-green-cyan-border-color{border-color:var(--wp--preset--color--light-green-cyan)!important}.has-vivid-green-cyan-border-color{border-color:var(--wp--preset--color--vivid-green-cyan)!important}.has-pale-cyan-blue-border-color{border-color:var(--wp--preset--color--pale-cyan-blue)!important}.has-vivid-cyan-blue-border-color{border-color:var(--wp--preset--color--vivid-cyan-blue)!important}.has-vivid-purple-border-color{border-color:var(--wp--preset--color--vivid-purple)!important}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background:var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple)!important}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background:var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan)!important}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background:var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange)!important}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background:var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red)!important}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background:var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray)!important}.has-cool-to-warm-spectrum-gradient-background{background:var(--wp--preset--gradient--cool-to-warm-spectrum)!important}.has-blush-light-purple-gradient-background{background:var(--wp--preset--gradient--blush-light-purple)!important}.has-blush-bordeaux-gradient-background{background:var(--wp--preset--gradient--blush-bordeaux)!important}.has-luminous-dusk-gradient-background{background:var(--wp--preset--gradient--luminous-dusk)!important}.has-pale-ocean-gradient-background{background:var(--wp--preset--gradient--pale-ocean)!important}.has-electric-grass-gradient-background{background:var(--wp--preset--gradient--electric-grass)!important}.has-midnight-gradient-background{background:var(--wp--preset--gradient--midnight)!important}.has-small-font-size{font-size:var(--wp--preset--font-size--small)!important}.has-medium-font-size{font-size:var(--wp--preset--font-size--medium)!important}.has-large-font-size{font-size:var(--wp--preset--font-size--large)!important}.has-x-large-font-size{font-size:var(--wp--preset--font-size--x-large)!important}</style>
<link rel='stylesheet' id='google_fonts-css' href='//fonts.googleapis.com/css?family=Lato:300,400,700|Raleway:400,300,700' type='text/css' media='all'/>
<link rel='stylesheet' id='font-awesome-css' href='/wp-content/themes/flat-bootstrap/font-awesome/css/font-awesome.min.css?ver=4.5.0' type='text/css' media='all'/>
<link rel='stylesheet' id='bootstrap-css' href='/wp-content/themes/flat-bootstrap/bootstrap/css/bootstrap.min.css?ver=3.3.6' type='text/css' media='all'/>
<link rel='stylesheet' id='theme-base-css' href='/wp-content/themes/flat-bootstrap/css/theme-base.css?ver=20160323' type='text/css' media='all'/>
<link rel='stylesheet' id='theme-flat-css' href='/wp-content/themes/flat-bootstrap/css/theme-flat.css?ver=20160323' type='text/css' media='all'/>
<link rel='stylesheet' id='flat-bootstrap-css' href='/wp-content/themes/flat-bootstrap/style.css?ver=6.0.11' type='text/css' media='all'/>
<link rel='stylesheet' id='jetpack_css-css' href='/wp-content/plugins/jetpack/css/jetpack.css?ver=8.5.3' type='text/css' media='all'/>
<script type='text/javascript' id='exactmetrics-frontend-script-js-extra'>//<![CDATA[
var exactmetrics_frontend={"js_events_tracking":"true","download_extensions":"zip,mp3,mpeg,pdf,docx,pptx,xlsx,rar","inbound_paths":"[{\"path\":\"\\\/go\\\/\",\"label\":\"affiliate\"},{\"path\":\"\\\/recommend\\\/\",\"label\":\"affiliate\"}]","home_url":"https:\/\/opnsec.com","hash_tracking":"false"};
//]]></script>
<script type='text/javascript' src='/wp-content/plugins/google-analytics-dashboard-for-wp/assets/js/frontend.min.js?ver=6.0.2' id='exactmetrics-frontend-script-js'></script>
<script type='text/javascript' src='/wp-includes/js/jquery/jquery.min.js?ver=3.6.0' id='jquery-core-js'></script>
<script type='text/javascript' src='/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'></script>
<link rel="https://api.w.org/" href="/wp-json/"/><link rel="alternate" type="application/json" href="/wp-json/wp/v2/posts/317"/><link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd"/>
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml"/> 
<meta name="generator" content="WordPress 6.0.11"/>
<link rel='shortlink' href='/?p=317'/>
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fopnsec.com%2F2018%2F07%2Finto-the-borg-ssrf-inside-google-production-network%2F"/>
<link rel="alternate" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fopnsec.com%2F2018%2F07%2Finto-the-borg-ssrf-inside-google-production-network%2F&#038;format=xml"/>
<style>.post-thumbnail img[src$=".svg"]{width:100%;height:auto}</style><style type='text/css'>img#wpstats{display:none}</style><style type="text/css">.recentcomments a{display:inline!important;padding:0!important;margin:0!important}</style>	<style type="text/css">.site-title a,.site-description{color:#16a085}.site-title a:hover,.site-title a:active,.site-title a:focus{opacity:.75}.navbar-brand{position:absolute;clip:rect(1px,1px,1px,1px)}</style>
	<meta name="twitter:widgets:link-color" content="#000000"><meta name="twitter:widgets:border-color" content="#000000"><meta name="twitter:partner" content="tfwp"><link rel="icon" href="/wp-content/uploads/2017/08/cropped-opnsec-32x32.png" sizes="32x32"/>
<link rel="icon" href="/wp-content/uploads/2017/08/cropped-opnsec-192x192.png" sizes="192x192"/>
<link rel="apple-touch-icon" href="/wp-content/uploads/2017/08/cropped-opnsec-180x180.png"/>
<meta name="msapplication-TileImage" content="/wp-content/uploads/2017/08/cropped-opnsec-270x270.png"/>


</head>

<body class="post-template-default single single-post postid-317 single-format-standard">
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-dark-grayscale"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "/><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="0 0.49803921568627"/><feFuncG type="table" tableValues="0 0.49803921568627"/><feFuncB type="table" tableValues="0 0.49803921568627"/><feFuncA type="table" tableValues="1 1"/></feComponentTransfer><feComposite in2="SourceGraphic" operator="in"/></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-grayscale"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "/><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="0 1"/><feFuncG type="table" tableValues="0 1"/><feFuncB type="table" tableValues="0 1"/><feFuncA type="table" tableValues="1 1"/></feComponentTransfer><feComposite in2="SourceGraphic" operator="in"/></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-purple-yellow"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "/><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="0.54901960784314 0.98823529411765"/><feFuncG type="table" tableValues="0 1"/><feFuncB type="table" tableValues="0.71764705882353 0.25490196078431"/><feFuncA type="table" tableValues="1 1"/></feComponentTransfer><feComposite in2="SourceGraphic" operator="in"/></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-blue-red"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "/><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="0 1"/><feFuncG type="table" tableValues="0 0.27843137254902"/><feFuncB type="table" tableValues="0.5921568627451 0.27843137254902"/><feFuncA type="table" tableValues="1 1"/></feComponentTransfer><feComposite in2="SourceGraphic" operator="in"/></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-midnight"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "/><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="0 0"/><feFuncG type="table" tableValues="0 0.64705882352941"/><feFuncB type="table" tableValues="0 1"/><feFuncA type="table" tableValues="1 1"/></feComponentTransfer><feComposite in2="SourceGraphic" operator="in"/></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-magenta-yellow"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "/><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="0.78039215686275 1"/><feFuncG type="table" tableValues="0 0.94901960784314"/><feFuncB type="table" tableValues="0.35294117647059 0.47058823529412"/><feFuncA type="table" tableValues="1 1"/></feComponentTransfer><feComposite in2="SourceGraphic" operator="in"/></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-purple-green"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "/><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="0.65098039215686 0.40392156862745"/><feFuncG type="table" tableValues="0 1"/><feFuncB type="table" tableValues="0.44705882352941 0.4"/><feFuncA type="table" tableValues="1 1"/></feComponentTransfer><feComposite in2="SourceGraphic" operator="in"/></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-blue-orange"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "/><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="0.098039215686275 1"/><feFuncG type="table" tableValues="0 0.66274509803922"/><feFuncB type="table" tableValues="0.84705882352941 0.41960784313725"/><feFuncA type="table" tableValues="1 1"/></feComponentTransfer><feComposite in2="SourceGraphic" operator="in"/></filter></defs></svg><div id="page" class="hfeed site">

		
	<header id="masthead" class="site-header" role="banner">

					<div id="site-branding" class="site-branding">
			
							<div class="container">
                                <div class="site-branding-text">
				<h1 class="site-title"><a href="/" rel="home">OpnSec</a></h1>
				<h2 class="site-description">Open mind Security and Crypto!</h2>
				</div>
				</div>
						</div><!-- .site-branding -->

					

			
		<nav id="site-navigation" class="main-navigation" role="navigation">

			<h2 class="menu-toggle screen-reader-text sr-only ">Primary Menu</h2>
			<div class="skip-link"><a class="screen-reader-text sr-only" href="#content">Skip to content</a></div>

		<div class="navbar navbar-default navbar-static-top"><div class="container"><div class="navbar-header"><button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a class="navbar-brand" href="/" rel="home">OpnSec</a></div><!-- navbar-header --><div class="navbar-collapse collapse"><div class="menu-test-container"><ul id="menu-test" class="nav navbar-nav"><li id="menu-item-313" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-313"><a title="About Me" href="/about-me/">About Me</a></li>
</ul></div>
		</div><!-- .container -->
		</div><!-- .navbar -->
		</nav><!-- #site-navigation -->

	</header><!-- #masthead -->

		
	<div id="content" class="site-content">



			<header class="content-header">
		<div class="container">
		<h1 class="page-title">Into the Borg &#8211; SSRF inside Google production network</h1>
				</div>
		</header>

	

<a id="pagetop"></a>



<div class="container">
<div id="main-grid" class="row">

	<div id="primary" class="content-area col-md-8">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-317" class="post-317 post type-post status-publish format-standard hentry category-google tag-borg tag-google tag-kubernetes tag-ssrf">

	
<header class="entry-header">
	<div class="entry-meta">
	
		
		
						<p><span class="posted-on"><span class="glyphicon glyphicon-calendar"></span>&nbsp;
			July 20, 2018 
			</span>
	
			
		
					 &nbsp;|&nbsp;<span class="comments-link">
			 <span class="glyphicon glyphicon-comment"></span>&nbsp;
			 <a href="/2018/07/into-the-borg-ssrf-inside-google-production-network/#comments" class="smoothscroll">7 Comments</a>			 </span>
		
				
	</div><!-- .entry-meta -->
</header><!-- .entry-header -->
	
	<div id="xsbf-entry-content" class="entry-content">
		<h3><img class=" wp-image-327 aligncenter" src="/wp-content/uploads/2018/07/borg2-1024x498.png" alt="Borglet status monitor" width="864" height="420" srcset="/wp-content/uploads/2018/07/borg2-1024x498.png 1024w, /wp-content/uploads/2018/07/borg2-300x146.png 300w, /wp-content/uploads/2018/07/borg2-768x374.png 768w, /wp-content/uploads/2018/07/borg2.png 1864w" sizes="(max-width: 864px) 100vw, 864px"/></h3>
<h3></h3>
<h3>Intro &#8211; Testing Google Sites and Google Caja</h3>
<p>In March 2018, I reported an XSS in <a href="https://developers.google.com/caja/" target="_blank" rel="noopener noreferrer">Google Caja</a>, a tool to securely embed arbitrary html/javascript in a webpage.<br/>
In May 2018, after the XSS was fixed, I realised that Google Sites was using an unpatched version of Google Caja, so I looked if it was vulnerable to the XSS. However, the XSS wasn&#8217;t exploitable there.</p>
<p>Google Caja parses html/javascript and modifies it to remove any javascript sensitive content, such as iframe or object tags and javascript sensitive properties such as document.cookie. Caja mostly parses and sanitizes HTML tags on the client side. However, for remote javascript tag (&lt;script src=&#8221;xxx&#8221;&gt;), the remote resource was fetched, parsed and sanitized on the server-side.<br/>
I tried to host a javascript file on my server (https://[attacker].com/script.js) and check if the Google Sites server would fall for the XSS when parsed server-side but the server replied that https://[attacker].com/script.js was not accessible.</p>
<p>After a few tests, I realised that the Google Sites Caja server would only fetch Google-owned resources like https://www.google.com or https://www.gstatic.com, but not any external resource like https://www.facebook.com.<br/>
That&#8217;s a strange behavior because this functionality is meant to fetch external resources so it looks like a broken feature. More interestingly, it is hard to determine whether an arbitrary URL belongs to Google or not, given the breadth of Google services. Unless&#8230;</p>
<p>&nbsp;</p>
<h3>Finding an SSRF in Google</h3>
<p>Whenever I find an endpoint that fetches arbitrary content server-side, I always test for SSRF. I did it a hundred times on Google services but never had any luck. Anyway the only explanation for the weird behavior of the Google Caja server was that the fetching was happening on the internal Google network and that is why it could only fetch Google-owned resources but not external resources. I already knew this was a bug, now the question was whether it was a security bug!</p>
<p>It&#8217;s very easy to host and run arbitrary code on Google servers, use Google Cloud services! I created a <a href="https://cloud.google.com/appengine/" target="_blank" rel="noopener noreferrer">Google App Engine</a> instance and hosted a javascript file. I then used the URL of this javascript file on Google Sites as a external script resource and updated the Google Sites page. The javascript was successfully fetched and parsed by Google Caja server. I then checked my Google App Engine instance logs to see from where the resource was fetched and it came from 10.x.x.201, a private network IP! This looked very promising.</p>
<p>I used the private IP as the url for the Google Sites javascript external resource and waited for the moment of truth. The request took more than 30 seconds to complete and at that time I really thought the request was blocked and I almost closed the page since I never had any luck with SSRF on Google before. However, when Google Caja replied, I saw that the reply size wasn&#8217;t around 1 KB like for a typical error message but 1 MB instead! One million bytes of information coming from a 10.x.x.x IP from Google internal network, I can tell you I was excited at this point! ðŸ™‚<br/>
I opened the file and indeed it was full of private information from Google! \o/</p>
<p>&nbsp;</p>
<h3>Google, from the inside</h3>
<p>First I want to say that I didn&#8217;t scan Google&#8217;s internal network. I only made 3 requests in the network to confirm the vulnerability and immediately sent a report to Google VRP. It took 48 hours to Google to fix the issue (I reported it on a Saturday), so in the meantime I couldn&#8217;t help but test 2-3 more requests to try to pivot the SSRF vulnerability into unrestricted file access or RCE but without luck.</p>
<p><img loading="lazy" class="aligncenter wp-image-326 size-full" src="/wp-content/uploads/2018/07/borg-1.png" alt="Architecture of Borg" width="490" height="431" srcset="/wp-content/uploads/2018/07/borg-1.png 490w, /wp-content/uploads/2018/07/borg-1-300x264.png 300w" sizes="(max-width: 490px) 100vw, 490px"/></p>
<p>The first request was to http://10.x.x.201/. It responded with a server status monitoring page of a &#8220;Borglet&#8221;. After a Google search, I could confirm that I was indeed inside <a href="https://storage.googleapis.com/pub-tools-public-publication-data/pdf/43438.pdf" target="_blank" rel="noopener noreferrer"><strong>Borg, Google&#8217;s internal large-scale cluster management system</strong></a>Â (<a href="https://www.infoq.com/news/2015/04/google-borg" target="_blank" rel="noopener noreferrer">here</a> is a overview of the architecture). Google have open sourced the <a href="https://kubernetes.io/blog/2015/04/borg-predecessor-to-kubernetes/" target="_blank" rel="noopener noreferrer">successor of Borg, Kubernetes</a> in 2014. It seems that while Kubernetes is getting more and more popular, Google is still relying on Borg for its internal production infrastructure, but I can tell you it&#8217;s not because of the design of Borg interfaces! (edit: this is intended as a jokeÂ ðŸ˜› )<br/>
The second request was to http://10.x.x.1/ and it was also a monitoring page for another Borglet. The third request was http://10.x.x.1/getstatus, a different status monitoring page of a Borglet with more details on the jobs like permissions, arguments.</p>
<p>Each Borglet represents a machine, a server.</p>
<p>On the hardware side, both servers were using Haswell&#8217;s CPU @2.30GHz with 72 cores, which corresponds to a set of 2 or 3 Xeon E5 v3. Both servers were using the CPUs at 77%. They had 250GB of RAM, which was used at 70%. They had 1 HDD each with 2TB and no SSD. The HDD were almost empty with only 15GB used, so the data is stored elsewhere.</p>
<p>The processing jobs (alloc and tasks) are very diverse, I believe this optimizes ressource usage with some jobs using memory, others using CPU, network, some with high priority, etc&#8230; Some services seem very active : Video encoding, Gmail and Ads. That should not be surprising since video processing is very heavy, Gmail is one of the main Google services and Ads is, well, Google&#8217;s core business. ðŸ˜‰<br/>
I didn&#8217;t see Google Sites or Caja in the jobs list, so either the SSRF was going through a proxy or the Borglet on 10.x.x.201 was from a different network than theÂ 10.x.x.201 IP I saw in my Google App Engine instance logs.</p>
<p>Regarding the architecture, we can find jobs related to almost all of the components of the <a href="http://malteschwarzkopf.de/research/assets/google-stack.pdf" target="_blank" rel="noopener noreferrer">Google Stack</a>, in particular MapReduce, BitTable, Flume, GFS&#8230;<br/>
On the technology side, Java seems to be heavily used. I didn&#8217;t see any mention of Python, C++, NodeJS or Go, but that doesn&#8217;t mean it wasn&#8217;t used so don&#8217;t draw conclusions. ðŸ˜›<br/>
I should mention that Borg, like Kubernetes, relies on containers like Docker, and VMs. For video processing, it seems they are using <a href="https://github.com/google/gvisor" target="_blank" rel="noopener noreferrer">Gvisor</a>, a Google open-source tool that looks like a trade-off between containers performance and VMs security.</p>
<p>Parameters gives some information on how to reach the applications through network ports. On Borg, it seems that all applications on a server share the same IP address and each has some dedicated ports.</p>
<p>Apps arguments were the most fun part for me because it is almost code. I didn&#8217;t find Google Search secret algorithm but there was some cool queries like this:<pre><code>MSCR(M(Customer.AdGroupCriterion+Customer.AdGroupCriterion-marshal+FilterDurianAdGroupCriterion+FilterNeedReviewAdGroupCriterion+GroupAdGroupCriterionByAdGroupKey+JoinAdGroupData/MakeUnionTable:3)+M(JoinAdGroupData/MakeUnionTable:2)+M(Customer.AdGroup+Customer.AdGroup-marshal+FilterDurianAdGroup+ParDo(AdGroupDataStripFieldsFn)+JoinAdGroupData/MakeUnionTable)+R(JoinAdGroupData/GroupUnionTables+JoinAdGroupData/ConstructJoinResults+JoinAdGroupData/ExtractTuples+ExtractCreativeAndKeywordReviewables))</code></pre></p>
<p>If you wonder what&#8217;s Gmail system user, it&#8217;s <pre><code>gmail@prod.google.com</code></pre>There is also a user &#8220;legal-discovery@prod.google.com&#8221; that has permission &#8220;auth.impersonation.impersonateNormalUser&#8221; on &#8220;mdb:all-person-users&#8221;. (edit: for clarification, I just saw these strings close to each other in a big array and assumed that&#8217;s what it meant)</p>
<p>There was also a little bit of history which showed that most jobs where aborted before finishing.</p>
<p>At last, there was a lot of url to other servers or applications endpoints. In particular, I tried to access a promising-looking http://wiki/ url but it didn&#8217;t work. I tested a <pre><code>/getFile?FileName=/sys/borglet/borglet.INFO</code></pre> url but got an unauthorized response. I also tried to change the FileName parameter but got error messages.</p>
<p>&nbsp;</p>
<h3>Google VRP response</h3>
<p>I reported the issue on Saturday May 12, 2018, and it was automatically triaged as a P3 (medium priority) issue. On Sunday I sent an email to Google Security that they might want someone to have a look at this. On Monday morning the issue was escalated to P0 (critical) then later decreased to P1. On Monday night the vulnerable endpoint was removed and the issue fixed.</p>
<p>It&#8217;s not easy to determine the impact of an SSRF because it really depends on what&#8217;s in the internal network. Google tends to keep most of its infrastructure available internally and uses a lot of web endpoints, which means that in case of a SSRF, an attacker could potentially access hundreds if not thousands of internal web applications. On the other hand, Google heavily relies on authentication to access resources which limits the impact of a SSRF.<br/>
In this case, the Borglet status monitoring page wasn&#8217;t authenticated, and it leaked a lot of information about the infrastructure. My understanding is that in Kubernetes, this page is authenticated.</p>
<p>Google VRP rewarded me with $13,337, which corresponds to something like unrestricted file access! They explained that while most internal resources would require authentication, they have seen in the past dev or debug handlers giving access to more than just info leaks, so they decided to reward for the maximum potential impact. I&#8217;d like to thank them for the bounty and for their quick response.</p>
<p>&nbsp;</p>
<p>That&#8217;s it for this story, I hope you enjoyed it as much I did and feel free to comment!</p>
<div id="xsbf-after-content" class="after-content">

<div class="twitter-share"><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fopnsec.com%2F2018%2F07%2Finto-the-borg-ssrf-inside-google-production-network%2F&#038;via=opnsec" class="twitter-share-button">Tweet</a></div>
</div><!-- .after-content -->		
		

	<footer class="entry-meta">

					 
							<span class="cat-links"><span class="glyphicon glyphicon-tag"></span>&nbsp;
				<a href="/category/google/" rel="category tag">Google</a>				</span>
					
		<span class="tags-links"><span class="glyphicon glyphicon-tags"></span> &nbsp;<a href="/tag/borg/" rel="tag">Borg</a>, <a href="/tag/google/" rel="tag">Google</a>, <a href="/tag/kubernetes/" rel="tag">Kubernetes</a>, <a href="/tag/ssrf/" rel="tag">SSRF</a></span> 

				
	</footer><!-- .entry-meta -->



		
		
	</div><!-- .entry-content -->

</article><!-- #post-## -->

			
<div id="comments" class="comments-area">

	
			<h2 class="comments-title">
			7 comments on &ldquo;<span>Into the Borg &#8211; SSRF inside Google production network</span>&rdquo;		</h2>

		
		<ul class="comment-list">
			
	<li id="comment-825" class="comment even thread-even depth-1 parent">
		<article id="div-comment-825" class="comment-body">
			<footer class="comment-meta">
				<div class="comment-author vcard">
					<img alt='' src='https://secure.gravatar.com/avatar/b32e93c088ab8ce3352086482e77e60d?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/b32e93c088ab8ce3352086482e77e60d?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 thumbnail photo' height='60' width='60' loading='lazy'/>					<cite class="fn">Joe Ovez</cite> <span class="says">says:</span>				</div><!-- .comment-author -->

				<div class="comment-metadata">
					<a href="/2018/07/into-the-borg-ssrf-inside-google-production-network/#comment-825">
						<time datetime="2018-07-20T20:48:36+00:00">
							July 20, 2018 at 8:48 pm						</time>
					</a>
									</div><!-- .comment-metadata -->

							</footer><!-- .comment-meta -->

			<div class="comment-content">
				<p>This is a great find. SSRF is a really unappreciated vulnerability; it is usually game-over. That it came from a Caja audit adds some tasty irony.</p>
<p>A friendly word of advice: when you find flaws like this (you, the reader, not you, the guy who wrote this post), think carefully before disclosing internal network details you discover like this writer did. The internal details of a target network don&#8217;t become public domain simply because you found a vulnerability. There are firms that get extremely itchy about this kind of stuff getting published, and I can&#8217;t blame them.</p>
			</div><!-- .comment-content -->

					</article><!-- .comment-body -->

	<ul class="children">

	<li id="comment-826" class="comment byuser comment-author-opnsec bypostauthor odd alt depth-2 parent">
		<article id="div-comment-826" class="comment-body">
			<footer class="comment-meta">
				<div class="comment-author vcard">
					<img alt='' src='https://secure.gravatar.com/avatar/ad925bdf7fba0f9608daa94bb809531a?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ad925bdf7fba0f9608daa94bb809531a?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 thumbnail photo' height='60' width='60' loading='lazy'/>					<cite class="fn"><a href='' rel='external nofollow ugc' class='url'>Engue Gillier</a></cite> <span class="says">says:</span>				</div><!-- .comment-author -->

				<div class="comment-metadata">
					<a href="/2018/07/into-the-borg-ssrf-inside-google-production-network/#comment-826">
						<time datetime="2018-07-20T21:59:01+00:00">
							July 20, 2018 at 9:59 pm						</time>
					</a>
									</div><!-- .comment-metadata -->

							</footer><!-- .comment-meta -->

			<div class="comment-content">
				<p>Thanks!<br/>
You&#8217;re right, disclosure should be done responsibly. I believe I didn&#8217;t disclose any sensitive information, my post is just informative, with a little bit of humor that might not be understood by everybody ðŸ˜›<br/>
My intent is to show that there is no magic behind this, it&#8217;s just engineering, and it&#8217;s beautiful when it&#8217;s well done!</p>
			</div><!-- .comment-content -->

					</article><!-- .comment-body -->

	<ul class="children">

	<li id="comment-828" class="comment even depth-3 parent">
		<article id="div-comment-828" class="comment-body">
			<footer class="comment-meta">
				<div class="comment-author vcard">
					<img alt='' src='https://secure.gravatar.com/avatar/6da1612dfb2cabf21f990156b3d0aa62?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/6da1612dfb2cabf21f990156b3d0aa62?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 thumbnail photo' height='60' width='60' loading='lazy'/>					<cite class="fn">MJ</cite> <span class="says">says:</span>				</div><!-- .comment-author -->

				<div class="comment-metadata">
					<a href="/2018/07/into-the-borg-ssrf-inside-google-production-network/#comment-828">
						<time datetime="2018-07-20T23:31:18+00:00">
							July 20, 2018 at 11:31 pm						</time>
					</a>
									</div><!-- .comment-metadata -->

							</footer><!-- .comment-meta -->

			<div class="comment-content">
				<p>FYI &#8211; the above post is from a spammer that has copied tptacek&#8217;s top comment on the HN article: <a href="https://news.ycombinator.com/item?id=17576720" rel="nofollow ugc">https://news.ycombinator.com/item?id=17576720</a></p>
			</div><!-- .comment-content -->

					</article><!-- .comment-body -->

	<ul class="children">

	<li id="comment-829" class="comment byuser comment-author-opnsec bypostauthor odd alt depth-4">
		<article id="div-comment-829" class="comment-body">
			<footer class="comment-meta">
				<div class="comment-author vcard">
					<img alt='' src='https://secure.gravatar.com/avatar/ad925bdf7fba0f9608daa94bb809531a?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ad925bdf7fba0f9608daa94bb809531a?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 thumbnail photo' height='60' width='60' loading='lazy'/>					<cite class="fn"><a href='' rel='external nofollow ugc' class='url'>Engue Gillier</a></cite> <span class="says">says:</span>				</div><!-- .comment-author -->

				<div class="comment-metadata">
					<a href="/2018/07/into-the-borg-ssrf-inside-google-production-network/#comment-829">
						<time datetime="2018-07-21T00:40:26+00:00">
							July 21, 2018 at 12:40 am						</time>
					</a>
									</div><!-- .comment-metadata -->

							</footer><!-- .comment-meta -->

			<div class="comment-content">
				<p>I see, interesting conversations out there!</p>
			</div><!-- .comment-content -->

					</article><!-- .comment-body -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li id="comment-840" class="comment even thread-odd thread-alt depth-1">
		<article id="div-comment-840" class="comment-body">
			<footer class="comment-meta">
				<div class="comment-author vcard">
					<img alt='' src='https://secure.gravatar.com/avatar/62e7d95199562c72075a963080e52f96?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/62e7d95199562c72075a963080e52f96?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 thumbnail photo' height='60' width='60' loading='lazy'/>					<cite class="fn">concerned</cite> <span class="says">says:</span>				</div><!-- .comment-author -->

				<div class="comment-metadata">
					<a href="/2018/07/into-the-borg-ssrf-inside-google-production-network/#comment-840">
						<time datetime="2018-07-21T22:25:06+00:00">
							July 21, 2018 at 10:25 pm						</time>
					</a>
									</div><!-- .comment-metadata -->

							</footer><!-- .comment-meta -->

			<div class="comment-content">
				<p>the joe ovez link url links to a malicious site. please sanitize</p>
			</div><!-- .comment-content -->

					</article><!-- .comment-body -->

	</li><!-- #comment-## -->

	<li id="comment-2072" class="comment odd alt thread-even depth-1">
		<article id="div-comment-2072" class="comment-body">
			<footer class="comment-meta">
				<div class="comment-author vcard">
					<img alt='' src='https://secure.gravatar.com/avatar/040bcbe633f57f512ded51d3ee56c2b9?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/040bcbe633f57f512ded51d3ee56c2b9?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 thumbnail photo' height='60' width='60' loading='lazy'/>					<cite class="fn">Jon DeGeorge</cite> <span class="says">says:</span>				</div><!-- .comment-author -->

				<div class="comment-metadata">
					<a href="/2018/07/into-the-borg-ssrf-inside-google-production-network/#comment-2072">
						<time datetime="2018-11-22T03:57:46+00:00">
							November 22, 2018 at 3:57 am						</time>
					</a>
									</div><!-- .comment-metadata -->

							</footer><!-- .comment-meta -->

			<div class="comment-content">
				<p>The &#8220;cafe&#8221; task on the Borglet page stands for Content Ads Front End, the component of the Google Ads network that displays ads on participating websites.<br/>
The &#8220;apps-upload&#8221; task is many Google-wide upload dialogs (e.g. the Gmail photo upload and profile picture upload boxes)<br/>
You mentioned that you saw nothing that said sites. &#8220;jotspot&#8221; is the original name for classic Google Sites, and &#8220;atari&#8221; is the codename for New Google Sites.</p>
			</div><!-- .comment-content -->

					</article><!-- .comment-body -->

	</li><!-- #comment-## -->

	<li id="comment-44398" class="comment even thread-odd thread-alt depth-1">
		<article id="div-comment-44398" class="comment-body">
			<footer class="comment-meta">
				<div class="comment-author vcard">
					<img alt='' src='https://secure.gravatar.com/avatar/7d2fe9243d955e88add870da7a3d8f2b?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/7d2fe9243d955e88add870da7a3d8f2b?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 thumbnail photo' height='60' width='60' loading='lazy'/>					<cite class="fn">Benjamin Amywarach</cite> <span class="says">says:</span>				</div><!-- .comment-author -->

				<div class="comment-metadata">
					<a href="/2018/07/into-the-borg-ssrf-inside-google-production-network/#comment-44398">
						<time datetime="2020-05-03T16:16:53+00:00">
							May 3, 2020 at 4:16 pm						</time>
					</a>
									</div><!-- .comment-metadata -->

							</footer><!-- .comment-meta -->

			<div class="comment-content">
				<p>Great find. New to looking for bugs, initially was focused on information leakage in Google subdomains, but your blog has taught me to go deeper into the app.</p>
<p>Thanks!<br/>
ðŸ‘ðŸ‘â˜•</p>
			</div><!-- .comment-content -->

					</article><!-- .comment-body -->

	</li><!-- #comment-## -->
		</ul><!-- .comment-list -->

		
	
			<p class="no-comments">Comments are closed.</p>
	
	
</div><!-- #comments -->

		
		</main><!-- #main -->
	</div><!-- #primary -->

	<div id="secondary" class="widget-area col-md-4" role="complementary">
				<aside id="recent-posts-2" class="widget clearfix widget_recent_entries">
		<h2 class="widget-title">Recent Posts</h2>
		<ul>
											<li>
					<a href="/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/">DOM XSS in Gmail with a little help from Chrome</a>
									</li>
											<li>
					<a href="/2018/07/into-the-borg-ssrf-inside-google-production-network/" aria-current="page">Into the Borg &#8211; SSRF inside Google production network</a>
									</li>
											<li>
					<a href="/2018/03/stored-xss-on-facebook/">Stored XSS on Facebook</a>
									</li>
											<li>
					<a href="/2017/10/flashme-wordpress-vulnerability-disclosure-cve-2016-9263/">FlashME! &#8211; WordPress vulnerability disclosure [CVE-2016-9263]</a>
									</li>
											<li>
					<a href="/2017/10/cve-2016-9263-unpatched-xsf-vulnerability-in-wordpress/">[CVE-2016-9263] XSF vulnerability in WordPress [UPDATED]</a>
									</li>
					</ul>

		</aside><aside id="recent-comments-2" class="widget clearfix widget_recent_comments"><h2 class="widget-title">Recent Comments</h2><ul id="recentcomments"><li class="recentcomments"><span class="comment-author-link"><a href='' rel='external nofollow ugc' class='url'>Engue Gillier</a></span> on <a href="/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-48064">DOM XSS in Gmail with a little help from Chrome</a></li><li class="recentcomments"><span class="comment-author-link">vahhitiu</span> on <a href="/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-47020">DOM XSS in Gmail with a little help from Chrome</a></li><li class="recentcomments"><span class="comment-author-link">Just a nOob</span> on <a href="/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-46910">DOM XSS in Gmail with a little help from Chrome</a></li><li class="recentcomments"><span class="comment-author-link">Nani</span> on <a href="/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-46019">DOM XSS in Gmail with a little help from Chrome</a></li><li class="recentcomments"><span class="comment-author-link"><a href='' rel='external nofollow ugc' class='url'>Engue Gillier</a></span> on <a href="/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-45513">DOM XSS in Gmail with a little help from Chrome</a></li></ul></aside>	</div><!-- #secondary -->
</div><!-- .row -->
</div><!-- .container -->

	</div><!-- #content -->

	
	<div id="sidebar-pagebottom" class="sidebar-pagebottom">
				<aside id="block-4" class="widget widget_block clearfix"><div class="container">
<div class="wp-container-1 wp-block-buttons"></div>
</div><!-- container --></aside>	</div><!-- .sidebar-pagebottom -->


		<footer id="colophon" class="site-footer" role="contentinfo">
		
	

	
	
		  
	<div class="after-footer">
	<div class="container">

					<div class="footer-nav-menu pull-left">
			<nav id="footer-navigation" class="secondary-navigation" role="navigation">
				<h1 class="menu-toggle sr-only">Footer Menu</h1>
				
		<div class="sample-menu-footer-container">
		<ul id="sample-menu-footer" class="list-inline dividers">
		<li id="menu-item-sample-1" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-sample-1"><a class="smoothscroll" title="Back to top of page" href="#page"><span class="fa fa-angle-up"></span> Top</a></li><li id="menu-item-sample-2" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-sample-2"><a title="Home" href="">Home</a></li>
		</ul>
		</div>			</nav>
			</div><!-- .footer-nav-menu -->
		
					<div id="site-credits" class="site-credits pull-right">
			<span class="credits-copyright">&copy; 2026 <a href="/" rel="home">OpnSec</a>. </span><span class="credits-theme">Theme by <a href="http://xtremelysocial.com/wordpress/flat/" rel="profile" target="_blank">XtremelySocial</a>.</span>			</div><!-- .site-credits -->
		
	</div><!-- .container -->
	</div><!-- .after-footer -->
			
	</footer><!-- #colophon -->

</div><!-- #page -->

<style>.wp-container-1{display:flex;gap:.5em;flex-wrap:wrap;align-items:center}.wp-container-1>*{margin:0}</style>
<link rel='stylesheet' id='hljstheme-css' href='//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/agate.min.css?ver=0.6.2' type='text/css' media='all'/>
<script type='text/javascript' src='/wp-content/themes/flat-bootstrap/bootstrap/js/bootstrap.min.js?ver=3.3.6' id='bootstrap-js'></script>
<script type='text/javascript' src='/wp-content/themes/flat-bootstrap/js/theme.js?ver=20160303' id='theme-js'></script>
<script type='text/javascript' src='//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js?ver=0.6.2' id='hljs-js'></script>
<script type='text/javascript' id='twitter-wjs-js-extra'>//<![CDATA[
window.twttr=(function(w){t=w.twttr||{};t._e=[];t.ready=function(f){t._e.push(f);};return t;}(window));
//]]></script>
<script type="text/javascript" id="twitter-wjs" async defer src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
    <style>code.hljs{}</style>
    <script type="text/javascript">(function($,window){var init_fn_flag=false;var init_fn=(function(){if(init_fn_flag)return;init_fn_flag=true;hljs.configure({"tabReplace":"    ","useBR":true});$('pre code').each(function(i,block){hljs.highlightBlock(block);});});$(document).ready(init_fn);$(window).on("load",init_fn);})(jQuery,window);</script>
<script type='text/javascript' src='https://stats.wp.com/e-202608.js' async='async' defer='defer'></script>
<script type='text/javascript'>_stq=window._stq||[];_stq.push(['view',{v:'ext',j:'1:8.5.3',blog:'250189475',post:'317',tz:'0',srv:'opnsec.com'}]);_stq.push(['clickTrackerInit','250189475','317']);</script>

</body>
</html>