{"id":209,"date":"2017-10-12T14:28:34","date_gmt":"2017-10-12T14:28:34","guid":{"rendered":"https:\/\/opnsec.com\/?p=209"},"modified":"2021-07-30T20:07:09","modified_gmt":"2021-07-30T20:07:09","slug":"cve-2016-9263-unpatched-xsf-vulnerability-in-wordpress","status":"publish","type":"post","link":"https:\/\/opnsec.com\/2017\/10\/cve-2016-9263-unpatched-xsf-vulnerability-in-wordpress\/","title":{"rendered":"[CVE-2016-9263] XSF vulnerability in WordPress [UPDATED]"},"content":{"rendered":"<h3><img loading=\"lazy\" class=\"wp-image-213 aligncenter\" src=\"http:\/\/opnsec.com\/wp-content\/uploads\/2017\/10\/wordpress-vulnerable-1.jpg\" alt=\"\" width=\"528\" height=\"276\" srcset=\"https:\/\/opnsec.com\/wp-content\/uploads\/2017\/10\/wordpress-vulnerable-1.jpg 905w, https:\/\/opnsec.com\/wp-content\/uploads\/2017\/10\/wordpress-vulnerable-1-300x157.jpg 300w, https:\/\/opnsec.com\/wp-content\/uploads\/2017\/10\/wordpress-vulnerable-1-768x401.jpg 768w\" sizes=\"(max-width: 528px) 100vw, 528px\" \/><\/h3>\n<h5><strong>Please patch this issue on your WordPress websites immediately and ask WordPress to release a patched version before I publicly release technical details about this on Oct 19th 2017<\/strong><\/h5>\n<h3>What is the vulnerability ?<\/h3>\n<p>There is an <strong>unpatched vulnerability in latest and older WordPress releases<\/strong>. The vulnerability is a cross-domain Flash injection (<strong>XSF<\/strong>), which impact is <strong>similar to a Reflected XSS<\/strong> (or Same-Origin policy bypass).<br \/>\nThe vulnerable file is located at \/wp-includes\/js\/mediaelement\/<strong>flashmediaelement.swf<\/strong>.<\/p>\n<h3>Who is affected ?<\/h3>\n<p>Any up-to-date or older (for at least 2 years) version of WordPress is vulnerable by default. <strong>Every WordPress website is vulnerable<\/strong> to this as well as <strong>any other website hosted on the same subdomain<\/strong> as a WordPress website.<\/p>\n<p>The only WordPress websites that are not affected are those where the vulnerable file, flashmediaelement.swf, is hosted on a sandboxed domain. This is the case for sites hosted on wordpress.com for example.<\/p>\n<h3>What is the impact ?<\/h3>\n<p>The impact is similar to an (authenticated) Reflected XSS, except you can&#8217;t manipulate the DOM and read some values like header responses, and the victim must have Flash active. The attacker can send a malicious link that would execute arbitrary Flash code on the WordPress security sandbox. When a victim opens the malicious link, the attacker can perform &#8220;xhr style&#8221; requests with Flash to any URL in the WordPress domain, using the victim&#8217;s cookies. Attacker can then read the response source code (body) and steal the victims private info including any CSRF token. He can use the CSRF token to perform CSRF actions on behalf of the user. In the case of Facebook for example, this led to Facebook account takeover after the victim clicked on the malicious link.<\/p>\n<p>Because this is a Same-Origin policy bypass, the attacker can exploit this not only on the vulnerable WordPress site but also on any website located in the same subdomain (or same Origin) than the vulnerable WordPress site.<\/p>\n<h3>How to patch this ?<\/h3>\n<p>WordPress decided not to patch this issue for some (bad?) reasons. You should simply <strong>remove the vulnerable file<\/strong> at [WordPress_Home_URL]\/wp-includes\/js\/mediaelement\/flashmediaelement.swf (which is just a Flash fallback for embed videos not hosted on a streaming website).<\/p>\n<p>Or you can <strong>redirect<\/strong> [WordPress_Home_URL]\/wp-includes\/js\/mediaelement\/flashmediaelement.swf <strong>to a sandboxed domain<\/strong>, for example to https:\/\/x0.wp.com\/wp-includes\/js\/mediaelement\/flashmediaelement.swf.<\/p>\n<p>Either of these solutions will mitigate this issue.<\/p>\n<h3>What is the timeline of this vulnerability report ?<\/h3>\n<ul>\n<li>Aug 5th <strong>2016<\/strong>: I reported this issue to Automattic, then WordPress private Bug Bounty program, more than a year ago. WordPress contacted the author of the vulnerable code, mediaelement.js (created by John Dyer @johndyer), which provided a patched file very quickly. WordPress decided not to release the patch.<cite><\/cite><cite class=\"_Rm\"><\/cite><\/li>\n<li>Sep 15th 2016: I found that Facebook was using the same vulnerable code, so <strong>facebook.com was vulnerable to the same XSF vulnerability<\/strong> (similar to a reflected XSS on facebook.com). I reported it to Facebook which fixed it in 5 days.<\/li>\n<li>Nov 11th 2016: I requested a CVE for this to MITRE and was assigned <strong><span class=\"il\">CVE<\/span>-2016-9263<\/strong><\/li>\n<li>Sep 15th <strong>2017<\/strong>: I informed WordPress Security Team that I was going to publicly disclose <span class=\"il\">CVE<\/span>-2016-9263<\/li>\n<li>Oct 12th 2017: I publicly disclose the issue on my blog without any technical detail but with instructions how to patch.<\/li>\n<li><strong>Oct 19th 2017: I will publicly disclose technical details<\/strong> about this vulnerability, including <span style=\"text-decoration: line-through;\"><strong>how to exploit it<\/strong><\/span> [UPDATE]: <strong>Limited technical details<\/strong> are now available <a href=\"https:\/\/opnsec.com\/2017\/10\/flashme-wordpress-vulnerability-disclosure-cve-2016-9263\/\"><strong>here<\/strong><\/a><\/li>\n<\/ul>\n<h3>Why are you publicly disclosing this ?<\/h3>\n<p>I reported this issue to WordPress more than a year ago, with a working proof of concept, technical details and how to patch the issue. WordPress choose not to release the patch quickly provided by mediaelement.js team. On the other hand, Facebook patched the issue in 5 days. WordPress obviously has less resource than Facebook but this is not a valid excuse because it is the most used Website software in the world, and the patch has been ready for more than a year. They made a poor decision that endangers their users and many websites.<\/p>\n<p>I already reported this vulnerability to large websites like Uber, Spotify, etc&#8230;\u00a0 for many of which their main website was vulnerable because of this vulnerability in their WordPress site. Many of them patched it themselves. It is possible that this is now exploited as a consequence of the reports I sent to these organisations. I don&#8217;t accept that the public is not informed about this vulnerability.<\/p>\n<p><strong>Please patch this issue on your WordPress websites immediately and ask WordPress to release a patched version before I publicly release technical details about this on Oct 19th 2017.<\/strong><\/p>\n<h3>How can I contact you ?<\/h3>\n<p>You can find me on twitter (<strong>@opnsec<\/strong>). You can also contact me at wordpress \/at\\ opnsec \/dot\\ com.<\/p>\n\n<div class=\"twitter-share\"><a href=\"https:\/\/twitter.com\/intent\/tweet?via=opnsec\" class=\"twitter-share-button\">Tweet<\/a><\/div>\n","protected":false},"excerpt":{"rendered":"<p>Please patch this issue on your WordPress websites immediately and ask WordPress to release a patched version before I publicly release technical details about this on Oct 19th 2017 What is the vulnerability ? There is an unpatched vulnerability in latest and older WordPress releases. The vulnerability is a cross-domain Flash injection (XSF), which impact&hellip; <a class=\"read-more\" href=\"https:\/\/opnsec.com\/2017\/10\/cve-2016-9263-unpatched-xsf-vulnerability-in-wordpress\/\">Read More<\/a><\/p>\n","protected":false},"author":2,"featured_media":0,"comment_status":"closed","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"spay_email":""},"categories":[1],"tags":[],"jetpack_featured_media_url":"","_links":{"self":[{"href":"https:\/\/opnsec.com\/wp-json\/wp\/v2\/posts\/209"}],"collection":[{"href":"https:\/\/opnsec.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/opnsec.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/opnsec.com\/wp-json\/wp\/v2\/users\/2"}],"replies":[{"embeddable":true,"href":"https:\/\/opnsec.com\/wp-json\/wp\/v2\/comments?post=209"}],"version-history":[{"count":11,"href":"https:\/\/opnsec.com\/wp-json\/wp\/v2\/posts\/209\/revisions"}],"predecessor-version":[{"id":376,"href":"https:\/\/opnsec.com\/wp-json\/wp\/v2\/posts\/209\/revisions\/376"}],"wp:attachment":[{"href":"https:\/\/opnsec.com\/wp-json\/wp\/v2\/media?parent=209"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/opnsec.com\/wp-json\/wp\/v2\/categories?post=209"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/opnsec.com\/wp-json\/wp\/v2\/tags?post=209"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}