<!DOCTYPE html>
<html lang="en-US" prefix="og: https://ogp.me/ns#">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="/xmlrpc.php">

<title>DOM XSS in Gmail with a little help from Chrome | OpnSec</title>
<meta name='robots' content='max-image-preview:large'/>

<!-- All In One SEO Pack 3.6.2[280,349] -->
<script type="application/ld+json" class="aioseop-schema">{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"/#organization","url":"/","name":"OpnSec","sameAs":[]},{"@type":"WebSite","@id":"/#website","url":"/","name":"OpnSec","publisher":{"@id":"/#organization"},"potentialAction":{"@type":"SearchAction","target":"/?s={search_term_string}","query-input":"required name=search_term_string"}},{"@type":"WebPage","@id":"/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#webpage","url":"/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/","inLanguage":"en-US","name":"DOM XSS in Gmail with a little help from Chrome","isPartOf":{"@id":"/#website"},"breadcrumb":{"@id":"/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#breadcrumblist"},"datePublished":"2020-05-03T06:04:09+00:00","dateModified":"2021-07-30T20:07:09+00:00"},{"@type":"Article","@id":"/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#article","isPartOf":{"@id":"/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#webpage"},"author":{"@id":"/author/opnsec/#author"},"headline":"DOM XSS in Gmail with a little help from Chrome","datePublished":"2020-05-03T06:04:09+00:00","dateModified":"2021-07-30T20:07:09+00:00","commentCount":8,"mainEntityOfPage":{"@id":"/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#webpage"},"publisher":{"@id":"/#organization"},"articleSection":"Google"},{"@type":"Person","@id":"/author/opnsec/#author","name":"Engue Gillier","sameAs":[],"image":{"@type":"ImageObject","@id":"/#personlogo","url":"https://secure.gravatar.com/avatar/ad925bdf7fba0f9608daa94bb809531a?s=96&d=mm&r=g","width":96,"height":96,"caption":"Engue Gillier"}},{"@type":"BreadcrumbList","@id":"/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#breadcrumblist","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"/","url":"/","name":"OpnSec"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/","url":"/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/","name":"DOM XSS in Gmail with a little help from Chrome"}}]}]}</script>
<link rel="canonical" href="/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/"/>
<meta property="og:type" content="article"/>
<meta property="og:title" content="DOM XSS in Gmail with a little help from Chrome | OpnSec"/>
<meta property="og:description" content="How to use browser features to help find DOM XSS. The invisible Messages of Gmail Last year, I looked for DOM XSS in Gmail website. Instead of using url params or the emails themselves as the source o"/>
<meta property="og:url" content="/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/"/>
<meta property="og:site_name" content="OpnSec"/>
<meta property="og:image" content="/wp-content/uploads/2020/05/iframes-1024x547.png"/>
<meta property="article:published_time" content="2020-05-03T06:04:09Z"/>
<meta property="article:modified_time" content="2021-07-30T20:07:09Z"/>
<meta property="og:image:secure_url" content="/wp-content/uploads/2020/05/iframes-1024x547.png"/>
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:site" content="@opnsec.com"/>
<meta name="twitter:title" content="DOM XSS in Gmail with a little help from Chrome | OpnSec"/>
<meta name="twitter:description" content="How to use browser features to help find DOM XSS. The invisible Messages of Gmail Last year, I looked for DOM XSS in Gmail website. Instead of using url params or the emails themselves as the source o"/>
<meta name="twitter:image" content="/wp-content/uploads/2020/05/iframes-1024x547.png"/>
<!-- All In One SEO Pack -->
<link rel='dns-prefetch' href='//fonts.googleapis.com'/>
<link rel='dns-prefetch' href='//s.w.org'/>
<link rel="alternate" type="application/rss+xml" title="OpnSec &raquo; Feed" href="/feed/"/>
<link rel="alternate" type="application/rss+xml" title="OpnSec &raquo; Comments Feed" href="/comments/feed/"/>
<link rel="alternate" type="application/rss+xml" title="OpnSec &raquo; DOM XSS in Gmail with a little help from Chrome Comments Feed" href="/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/feed/"/>
<!-- This site uses the Google Analytics by ExactMetrics plugin v6.0.2 - Using Analytics tracking - https://www.exactmetrics.com/ -->
<script type="text/javascript" data-cfasync="false">var em_version='6.0.2';var em_track_user=true;var em_no_track_reason='';var disableStr='ga-disable-UA-108066765-1';function __gaTrackerIsOptedOut(){return document.cookie.indexOf(disableStr+'=true')>-1;}if(__gaTrackerIsOptedOut()){window[disableStr]=true;}function __gaTrackerOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';window[disableStr]=true;}if('undefined'===typeof gaOptout){function gaOptout(){__gaTrackerOptout();}}if(em_track_user){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','__gaTracker');window.ga=__gaTracker;__gaTracker('create','UA-108066765-1','auto');__gaTracker('set','forceSSL',true);__gaTracker('send','pageview');__gaTracker(function(){window.ga=__gaTracker;});}else{console.log("");(function(){var noopfn=function(){return null;};var noopnullfn=function(){return null;};var Tracker=function(){return null;};var p=Tracker.prototype;p.get=noopfn;p.set=noopfn;p.send=noopfn;var __gaTracker=function(){var len=arguments.length;if(len===0){return;}var f=arguments[len-1];if(typeof f!=='object'||f===null||typeof f.hitCallback!=='function'){console.log('Not running function __gaTracker('+arguments[0]+" ....) because you are not being tracked. "+em_no_track_reason);return;}try{f.hitCallback();}catch(ex){}};__gaTracker.create=function(){return new Tracker();};__gaTracker.getByName=noopnullfn;__gaTracker.getAll=function(){return[];};__gaTracker.remove=noopfn;window['__gaTracker']=__gaTracker;window.ga=__gaTracker;})();}</script>
<!-- / Google Analytics by ExactMetrics -->
<script type="text/javascript">window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/opnsec.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.0.11"}};!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode,e=(p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0),i.toDataURL());return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([129777,127995,8205,129778,127999],[129777,127995,8203,129778,127999])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(e=t.source||{}).concatemoji?c(e.concatemoji):e.wpemoji&&e.twemoji&&(c(e.twemoji),c(e.wpemoji)))}(window,document,window._wpemojiSettings);</script>
<style type="text/css">img.wp-smiley,img.emoji{display:inline!important;border:none!important;box-shadow:none!important;height:1em!important;width:1em!important;margin:0 .07em!important;vertical-align:-.1em!important;background:none!important;padding:0!important}</style>
	<link rel='stylesheet' id='wp-block-library-css' href='/wp-includes/css/dist/block-library/style.min.css?ver=6.0.11' type='text/css' media='all'/>
<style id='wp-block-library-inline-css' type='text/css'>.has-text-align-justify{text-align:justify}</style>
<style id='global-styles-inline-css' type='text/css'>body{--wp--preset--color--black:#000;--wp--preset--color--cyan-bluish-gray:#abb8c3;--wp--preset--color--white:#fff;--wp--preset--color--pale-pink:#f78da7;--wp--preset--color--vivid-red:#cf2e2e;--wp--preset--color--luminous-vivid-orange:#ff6900;--wp--preset--color--luminous-vivid-amber:#fcb900;--wp--preset--color--light-green-cyan:#7bdcb5;--wp--preset--color--vivid-green-cyan:#00d084;--wp--preset--color--pale-cyan-blue:#8ed1fc;--wp--preset--color--vivid-cyan-blue:#0693e3;--wp--preset--color--vivid-purple:#9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple:linear-gradient(135deg,rgba(6,147,227,1) 0%,#9b51e0 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan:linear-gradient(135deg,#7adcb4 0%,#00d082 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange:linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red:linear-gradient(135deg,rgba(255,105,0,1) 0%,#cf2e2e 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray:linear-gradient(135deg,#eee 0%,#a9b8c3 100%);--wp--preset--gradient--cool-to-warm-spectrum:linear-gradient(135deg,#4aeadc 0%,#9778d1 20%,#cf2aba 40%,#ee2c82 60%,#fb6962 80%,#fef84c 100%);--wp--preset--gradient--blush-light-purple:linear-gradient(135deg,#ffceec 0%,#9896f0 100%);--wp--preset--gradient--blush-bordeaux:linear-gradient(135deg,#fecda5 0%,#fe2d2d 50%,#6b003e 100%);--wp--preset--gradient--luminous-dusk:linear-gradient(135deg,#ffcb70 0%,#c751c0 50%,#4158d0 100%);--wp--preset--gradient--pale-ocean:linear-gradient(135deg,#fff5cb 0%,#b6e3d4 50%,#33a7b5 100%);--wp--preset--gradient--electric-grass:linear-gradient(135deg,#caf880 0%,#71ce7e 100%);--wp--preset--gradient--midnight:linear-gradient(135deg,#020381 0%,#2874fc 100%);--wp--preset--duotone--dark-grayscale:url(#wp-duotone-dark-grayscale);--wp--preset--duotone--grayscale:url(#wp-duotone-grayscale);--wp--preset--duotone--purple-yellow:url(#wp-duotone-purple-yellow);--wp--preset--duotone--blue-red:url(#wp-duotone-blue-red);--wp--preset--duotone--midnight:url(#wp-duotone-midnight);--wp--preset--duotone--magenta-yellow:url(#wp-duotone-magenta-yellow);--wp--preset--duotone--purple-green:url(#wp-duotone-purple-green);--wp--preset--duotone--blue-orange:url(#wp-duotone-blue-orange);--wp--preset--font-size--small:13px;--wp--preset--font-size--medium:20px;--wp--preset--font-size--large:36px;--wp--preset--font-size--x-large:42px}.has-black-color{color:var(--wp--preset--color--black)!important}.has-cyan-bluish-gray-color{color:var(--wp--preset--color--cyan-bluish-gray)!important}.has-white-color{color:var(--wp--preset--color--white)!important}.has-pale-pink-color{color:var(--wp--preset--color--pale-pink)!important}.has-vivid-red-color{color:var(--wp--preset--color--vivid-red)!important}.has-luminous-vivid-orange-color{color:var(--wp--preset--color--luminous-vivid-orange)!important}.has-luminous-vivid-amber-color{color:var(--wp--preset--color--luminous-vivid-amber)!important}.has-light-green-cyan-color{color:var(--wp--preset--color--light-green-cyan)!important}.has-vivid-green-cyan-color{color:var(--wp--preset--color--vivid-green-cyan)!important}.has-pale-cyan-blue-color{color:var(--wp--preset--color--pale-cyan-blue)!important}.has-vivid-cyan-blue-color{color:var(--wp--preset--color--vivid-cyan-blue)!important}.has-vivid-purple-color{color:var(--wp--preset--color--vivid-purple)!important}.has-black-background-color{background-color:var(--wp--preset--color--black)!important}.has-cyan-bluish-gray-background-color{background-color:var(--wp--preset--color--cyan-bluish-gray)!important}.has-white-background-color{background-color:var(--wp--preset--color--white)!important}.has-pale-pink-background-color{background-color:var(--wp--preset--color--pale-pink)!important}.has-vivid-red-background-color{background-color:var(--wp--preset--color--vivid-red)!important}.has-luminous-vivid-orange-background-color{background-color:var(--wp--preset--color--luminous-vivid-orange)!important}.has-luminous-vivid-amber-background-color{background-color:var(--wp--preset--color--luminous-vivid-amber)!important}.has-light-green-cyan-background-color{background-color:var(--wp--preset--color--light-green-cyan)!important}.has-vivid-green-cyan-background-color{background-color:var(--wp--preset--color--vivid-green-cyan)!important}.has-pale-cyan-blue-background-color{background-color:var(--wp--preset--color--pale-cyan-blue)!important}.has-vivid-cyan-blue-background-color{background-color:var(--wp--preset--color--vivid-cyan-blue)!important}.has-vivid-purple-background-color{background-color:var(--wp--preset--color--vivid-purple)!important}.has-black-border-color{border-color:var(--wp--preset--color--black)!important}.has-cyan-bluish-gray-border-color{border-color:var(--wp--preset--color--cyan-bluish-gray)!important}.has-white-border-color{border-color:var(--wp--preset--color--white)!important}.has-pale-pink-border-color{border-color:var(--wp--preset--color--pale-pink)!important}.has-vivid-red-border-color{border-color:var(--wp--preset--color--vivid-red)!important}.has-luminous-vivid-orange-border-color{border-color:var(--wp--preset--color--luminous-vivid-orange)!important}.has-luminous-vivid-amber-border-color{border-color:var(--wp--preset--color--luminous-vivid-amber)!important}.has-light-green-cyan-border-color{border-color:var(--wp--preset--color--light-green-cyan)!important}.has-vivid-green-cyan-border-color{border-color:var(--wp--preset--color--vivid-green-cyan)!important}.has-pale-cyan-blue-border-color{border-color:var(--wp--preset--color--pale-cyan-blue)!important}.has-vivid-cyan-blue-border-color{border-color:var(--wp--preset--color--vivid-cyan-blue)!important}.has-vivid-purple-border-color{border-color:var(--wp--preset--color--vivid-purple)!important}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background:var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple)!important}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background:var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan)!important}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background:var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange)!important}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background:var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red)!important}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background:var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray)!important}.has-cool-to-warm-spectrum-gradient-background{background:var(--wp--preset--gradient--cool-to-warm-spectrum)!important}.has-blush-light-purple-gradient-background{background:var(--wp--preset--gradient--blush-light-purple)!important}.has-blush-bordeaux-gradient-background{background:var(--wp--preset--gradient--blush-bordeaux)!important}.has-luminous-dusk-gradient-background{background:var(--wp--preset--gradient--luminous-dusk)!important}.has-pale-ocean-gradient-background{background:var(--wp--preset--gradient--pale-ocean)!important}.has-electric-grass-gradient-background{background:var(--wp--preset--gradient--electric-grass)!important}.has-midnight-gradient-background{background:var(--wp--preset--gradient--midnight)!important}.has-small-font-size{font-size:var(--wp--preset--font-size--small)!important}.has-medium-font-size{font-size:var(--wp--preset--font-size--medium)!important}.has-large-font-size{font-size:var(--wp--preset--font-size--large)!important}.has-x-large-font-size{font-size:var(--wp--preset--font-size--x-large)!important}</style>
<link rel='stylesheet' id='google_fonts-css' href='//fonts.googleapis.com/css?family=Lato:300,400,700|Raleway:400,300,700' type='text/css' media='all'/>
<link rel='stylesheet' id='font-awesome-css' href='/wp-content/themes/flat-bootstrap/font-awesome/css/font-awesome.min.css?ver=4.5.0' type='text/css' media='all'/>
<link rel='stylesheet' id='bootstrap-css' href='/wp-content/themes/flat-bootstrap/bootstrap/css/bootstrap.min.css?ver=3.3.6' type='text/css' media='all'/>
<link rel='stylesheet' id='theme-base-css' href='/wp-content/themes/flat-bootstrap/css/theme-base.css?ver=20160323' type='text/css' media='all'/>
<link rel='stylesheet' id='theme-flat-css' href='/wp-content/themes/flat-bootstrap/css/theme-flat.css?ver=20160323' type='text/css' media='all'/>
<link rel='stylesheet' id='flat-bootstrap-css' href='/wp-content/themes/flat-bootstrap/style.css?ver=6.0.11' type='text/css' media='all'/>
<link rel='stylesheet' id='jetpack_css-css' href='/wp-content/plugins/jetpack/css/jetpack.css?ver=8.5.3' type='text/css' media='all'/>
<script type='text/javascript' id='exactmetrics-frontend-script-js-extra'>//<![CDATA[
var exactmetrics_frontend={"js_events_tracking":"true","download_extensions":"zip,mp3,mpeg,pdf,docx,pptx,xlsx,rar","inbound_paths":"[{\"path\":\"\\\/go\\\/\",\"label\":\"affiliate\"},{\"path\":\"\\\/recommend\\\/\",\"label\":\"affiliate\"}]","home_url":"https:\/\/opnsec.com","hash_tracking":"false"};
//]]></script>
<script type='text/javascript' src='/wp-content/plugins/google-analytics-dashboard-for-wp/assets/js/frontend.min.js?ver=6.0.2' id='exactmetrics-frontend-script-js'></script>
<script type='text/javascript' src='/wp-includes/js/jquery/jquery.min.js?ver=3.6.0' id='jquery-core-js'></script>
<script type='text/javascript' src='/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'></script>
<link rel="https://api.w.org/" href="/wp-json/"/><link rel="alternate" type="application/json" href="/wp-json/wp/v2/posts/382"/><link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd"/>
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml"/> 
<meta name="generator" content="WordPress 6.0.11"/>
<link rel='shortlink' href='/?p=382'/>
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fopnsec.com%2F2020%2F05%2Fdom-xss-in-gmail-with-a-little-help-from-chrome%2F"/>
<link rel="alternate" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fopnsec.com%2F2020%2F05%2Fdom-xss-in-gmail-with-a-little-help-from-chrome%2F&#038;format=xml"/>
<style>.post-thumbnail img[src$=".svg"]{width:100%;height:auto}</style><style type='text/css'>img#wpstats{display:none}</style><style type="text/css">.recentcomments a{display:inline!important;padding:0!important;margin:0!important}</style>	<style type="text/css">.site-title a,.site-description{color:#16a085}.site-title a:hover,.site-title a:active,.site-title a:focus{opacity:.75}.navbar-brand{position:absolute;clip:rect(1px,1px,1px,1px)}</style>
	<meta name="twitter:widgets:link-color" content="#000000"><meta name="twitter:widgets:border-color" content="#000000"><meta name="twitter:partner" content="tfwp"><link rel="icon" href="/wp-content/uploads/2017/08/cropped-opnsec-32x32.png" sizes="32x32"/>
<link rel="icon" href="/wp-content/uploads/2017/08/cropped-opnsec-192x192.png" sizes="192x192"/>
<link rel="apple-touch-icon" href="/wp-content/uploads/2017/08/cropped-opnsec-180x180.png"/>
<meta name="msapplication-TileImage" content="/wp-content/uploads/2017/08/cropped-opnsec-270x270.png"/>


</head>

<body class="post-template-default single single-post postid-382 single-format-standard">
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-dark-grayscale"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "/><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="0 0.49803921568627"/><feFuncG type="table" tableValues="0 0.49803921568627"/><feFuncB type="table" tableValues="0 0.49803921568627"/><feFuncA type="table" tableValues="1 1"/></feComponentTransfer><feComposite in2="SourceGraphic" operator="in"/></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-grayscale"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "/><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="0 1"/><feFuncG type="table" tableValues="0 1"/><feFuncB type="table" tableValues="0 1"/><feFuncA type="table" tableValues="1 1"/></feComponentTransfer><feComposite in2="SourceGraphic" operator="in"/></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-purple-yellow"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "/><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="0.54901960784314 0.98823529411765"/><feFuncG type="table" tableValues="0 1"/><feFuncB type="table" tableValues="0.71764705882353 0.25490196078431"/><feFuncA type="table" tableValues="1 1"/></feComponentTransfer><feComposite in2="SourceGraphic" operator="in"/></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-blue-red"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "/><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="0 1"/><feFuncG type="table" tableValues="0 0.27843137254902"/><feFuncB type="table" tableValues="0.5921568627451 0.27843137254902"/><feFuncA type="table" tableValues="1 1"/></feComponentTransfer><feComposite in2="SourceGraphic" operator="in"/></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-midnight"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "/><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="0 0"/><feFuncG type="table" tableValues="0 0.64705882352941"/><feFuncB type="table" tableValues="0 1"/><feFuncA type="table" tableValues="1 1"/></feComponentTransfer><feComposite in2="SourceGraphic" operator="in"/></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-magenta-yellow"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "/><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="0.78039215686275 1"/><feFuncG type="table" tableValues="0 0.94901960784314"/><feFuncB type="table" tableValues="0.35294117647059 0.47058823529412"/><feFuncA type="table" tableValues="1 1"/></feComponentTransfer><feComposite in2="SourceGraphic" operator="in"/></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-purple-green"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "/><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="0.65098039215686 0.40392156862745"/><feFuncG type="table" tableValues="0 1"/><feFuncB type="table" tableValues="0.44705882352941 0.4"/><feFuncA type="table" tableValues="1 1"/></feComponentTransfer><feComposite in2="SourceGraphic" operator="in"/></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-blue-orange"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "/><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="0.098039215686275 1"/><feFuncG type="table" tableValues="0 0.66274509803922"/><feFuncB type="table" tableValues="0.84705882352941 0.41960784313725"/><feFuncA type="table" tableValues="1 1"/></feComponentTransfer><feComposite in2="SourceGraphic" operator="in"/></filter></defs></svg><div id="page" class="hfeed site">

		
	<header id="masthead" class="site-header" role="banner">

					<div id="site-branding" class="site-branding">
			
							<div class="container">
                                <div class="site-branding-text">
				<h1 class="site-title"><a href="/" rel="home">OpnSec</a></h1>
				<h2 class="site-description">Open mind Security and Crypto!</h2>
				</div>
				</div>
						</div><!-- .site-branding -->

					

			
		<nav id="site-navigation" class="main-navigation" role="navigation">

			<h2 class="menu-toggle screen-reader-text sr-only ">Primary Menu</h2>
			<div class="skip-link"><a class="screen-reader-text sr-only" href="#content">Skip to content</a></div>

		<div class="navbar navbar-default navbar-static-top"><div class="container"><div class="navbar-header"><button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a class="navbar-brand" href="/" rel="home">OpnSec</a></div><!-- navbar-header --><div class="navbar-collapse collapse"><div class="menu-test-container"><ul id="menu-test" class="nav navbar-nav"><li id="menu-item-313" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-313"><a title="About Me" href="/about-me/">About Me</a></li>
</ul></div>
		</div><!-- .container -->
		</div><!-- .navbar -->
		</nav><!-- #site-navigation -->

	</header><!-- #masthead -->

		
	<div id="content" class="site-content">



			<header class="content-header">
		<div class="container">
		<h1 class="page-title">DOM XSS in Gmail with a little help from Chrome</h1>
				</div>
		</header>

	

<a id="pagetop"></a>



<div class="container">
<div id="main-grid" class="row">

	<div id="primary" class="content-area col-md-8">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-382" class="post-382 post type-post status-publish format-standard hentry category-google">

	
<header class="entry-header">
	<div class="entry-meta">
	
		
		
						<p><span class="posted-on"><span class="glyphicon glyphicon-calendar"></span>&nbsp;
			May 3, 2020 
			</span>
	
			
		
					 &nbsp;|&nbsp;<span class="comments-link">
			 <span class="glyphicon glyphicon-comment"></span>&nbsp;
			 <a href="/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comments" class="smoothscroll">8 Comments</a>			 </span>
		
				
	</div><!-- .entry-meta -->
</header><!-- .entry-header -->
	
	<div id="xsbf-entry-content" class="entry-content">
		<p>How to use browser features to help find DOM XSS.</p>
<h3>The invisible Messages of Gmail</h3>
<p>Last year, I looked for DOM XSS in Gmail website. Instead of using url params or the emails themselves as the source of the attack, I decided to use the much more discreet yet ubiquitous <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage" target="_blank" rel="noopener noreferrer">postMessage</a> api.Â  At first glance, the Gmail inbox seems a simple webpage, but if you go through the looking glass, it&#8217;s actually a dozen of different webpages (or iframes) communicating between each others.</p>
<p><img class="alignnone size-large wp-image-384" src="/wp-content/uploads/2020/05/iframes-1024x547.png" alt="" width="1024" height="547" srcset="/wp-content/uploads/2020/05/iframes-1024x547.png 1024w, /wp-content/uploads/2020/05/iframes-300x160.png 300w, /wp-content/uploads/2020/05/iframes-768x410.png 768w, /wp-content/uploads/2020/05/iframes-1536x821.png 1536w, /wp-content/uploads/2020/05/iframes.png 1920w" sizes="(max-width: 1024px) 100vw, 1024px"/></p>
<p>My first task was to make the cross-frames messages visible. This is not a native feature in DevTools yet. Instead, you can use this simple <a href="https://github.com/opnsec/postMessage-logger" target="_blank" rel="noopener noreferrer">postMessage logger extension</a>. After reloading, the console is now overwhelmed with frame to frame messages going back and forth.</p>
<p><img loading="lazy" class="alignnone size-large wp-image-385" src="/wp-content/uploads/2020/05/postmessage-1024x547.png" alt="" width="1024" height="547" srcset="/wp-content/uploads/2020/05/postmessage-1024x547.png 1024w, /wp-content/uploads/2020/05/postmessage-300x160.png 300w, /wp-content/uploads/2020/05/postmessage-768x410.png 768w, /wp-content/uploads/2020/05/postmessage-1536x821.png 1536w, /wp-content/uploads/2020/05/postmessage.png 1600w" sizes="(max-width: 1024px) 100vw, 1024px"/></p>
<blockquote><p>Each message has a <strong>target</strong> (the frame which receives the message), a <strong>source</strong> (the frame which sent the message), an <strong>origin</strong> (the domain of the source) and the <strong>data</strong>, which can be a string or a JSON object (or any kind of object that <a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Structured_clone_algorithm">will be cloned</a> in the process). Messages can be sent by any frame to another, even from different domain and even from different tab if the source has a reference to the target, with window.opener, window.open() and window.frames.</p></blockquote>
<p>The target receives the message using <pre><code><span class="pl-en">addEventListener</span><span class="pl-kos">(</span><span class="pl-s">"message", function(message){/* handle message here */})</code></pre> like in the extension.</span></p>
<p>If there are too many messages, you can customize the extension to filter messages by any of their property. I was looking for interesting messages and one message in particular contained an url in the data:</p>
<p><img loading="lazy" class="alignnone size-large wp-image-387" src="/wp-content/uploads/2020/05/frame-1024x340.png" alt="" width="1024" height="340" srcset="/wp-content/uploads/2020/05/frame-1024x340.png 1024w, /wp-content/uploads/2020/05/frame-300x100.png 300w, /wp-content/uploads/2020/05/frame-768x255.png 768w, /wp-content/uploads/2020/05/frame.png 1182w" sizes="(max-width: 1024px) 100vw, 1024px"/></p>
<p>This message is sent by &#8220;hangouts.google.com&#8221; to &#8220;mail.google.com&#8221; . Not only is there a url in the message data, but the url contains the word &#8220;frame&#8221;. interesting&#8230;</p>
<h3>The browser Toolbox</h3>
<p>I went to the network tab of DevTools and filtered the requests by type &#8220;doc&#8221; which means &#8220;top window url and iframes src&#8221;. The same url was there:</p>
<p><img loading="lazy" class="alignnone size-large wp-image-389" src="/wp-content/uploads/2020/05/network-1024x480.png" alt="" width="1024" height="480" srcset="/wp-content/uploads/2020/05/network-1024x480.png 1024w, /wp-content/uploads/2020/05/network-300x141.png 300w, /wp-content/uploads/2020/05/network-768x360.png 768w, /wp-content/uploads/2020/05/network.png 1155w" sizes="(max-width: 1024px) 100vw, 1024px"/></p>
<p>I could also confirm that the request referrer was &#8220;mail.google.com&#8221; which was a good sign since it&#8217;s the domain that received the Message. The value in red circle is the initiator of the request, the JS code that loaded the iframe. You can click on it and it brings you directly to the corresponding code in the source tab. Unminify the code, set a breakpoint, reload and the breakpoint is hit:</p>
<p><img loading="lazy" class="alignnone size-large wp-image-390" src="/wp-content/uploads/2020/05/debug-1024x441.png" alt="" width="1024" height="441" srcset="/wp-content/uploads/2020/05/debug-1024x441.png 1024w, /wp-content/uploads/2020/05/debug-300x129.png 300w, /wp-content/uploads/2020/05/debug-768x331.png 768w, /wp-content/uploads/2020/05/debug.png 1533w" sizes="(max-width: 1024px) 100vw, 1024px"/></p>
<p>And voila! The function that triggers the request is appendChild(). This is pretty much all we can understand from the code which is unreadable. But with the magic of the debugger we can confirm that the argument contains an iframe with the src set to the url. If you click on the functions in the Call Stack on the right, you can navigate through the &#8220;control flow&#8221; of the program and understand its logic.</p>
<p>For example, here is how the message is received by the frame:</p>
<p><img loading="lazy" class="alignnone size-full wp-image-391" src="/wp-content/uploads/2020/05/listener.png" alt="" width="766" height="217" srcset="/wp-content/uploads/2020/05/listener.png 766w, /wp-content/uploads/2020/05/listener-300x85.png 300w" sizes="(max-width: 766px) 100vw, 766px"/></p>
<p>You can even see the code where the source of the message sent it:</p>
<p><img loading="lazy" class="alignnone size-full wp-image-392" src="/wp-content/uploads/2020/05/post.png" alt="" width="1013" height="319" srcset="/wp-content/uploads/2020/05/post.png 1013w, /wp-content/uploads/2020/05/post-300x94.png 300w, /wp-content/uploads/2020/05/post-768x242.png 768w" sizes="(max-width: 1013px) 100vw, 1013px"/></p>
<blockquote><p>There are dozens of functions between the listener and the loading of the url, across multiple files and thousands of lines of code. It is not uncommon that the browser freezes, breaks or skips breakpoint when you debug such heavy webpages, it&#8217;s a matter of trial and error! ðŸ˜‰</p></blockquote>
<p>I tried to send a message to the frame from the console with the same data but with &#8220;javascript:alert(1)&#8221; instead of the url. I didn&#8217;t got an alertbox, but a CSP error message.</p>
<p><img loading="lazy" class="alignnone size-large wp-image-393" src="/wp-content/uploads/2020/05/csp-1024x52.png" alt="" width="1024" height="52" srcset="/wp-content/uploads/2020/05/csp-1024x52.png 1024w, /wp-content/uploads/2020/05/csp-300x15.png 300w, /wp-content/uploads/2020/05/csp-768x39.png 768w, /wp-content/uploads/2020/05/csp-1536x79.png 1536w, /wp-content/uploads/2020/05/csp.png 1779w" sizes="(max-width: 1024px) 100vw, 1024px"/></p>
<p>Thankfully, this CSP rule wasn&#8217;t enforced by IE11 and Edge (at the time) so I was able to trigger the alertbox on those browsers. There was no check on the origin of the message. A simple attack scenario is to start from the attacker webpage, open a new tab to Gmail and inject the payload in the Gmail tab using postMessage. The Gmail tab loads the javascript iframe and the attacker has arbitrary code execution on the victim&#8217;s Gmail page, which means it can read and send emails, change password of accounts registered to this email etc&#8230;</p>
<h3>The random Channel Name</h3>
<p>There was still one issue: with so much communication between so many frames, it is easy to get confused, so messages usually have a channel name. The name is a random 6 char generated by &#8220;mail.google.com&#8221; and transmitted in the first message to &#8220;hangouts.google.com&#8221;. In all following messages that it receives, &#8220;hangouts.google.com&#8221; checks if it contains the correct channel name, and if not it doesn&#8217;t process the message.</p>
<p>The attacker doesn&#8217;t know the channel name, and 6 alphanumeric is too much possibilities to try all.<br/>
The random generator is &#8220;Math.random()&#8221; which is not secure and <a href="http://ifsec.blogspot.com/2012/09/of-html5-security-cross-domain.html" target="_blank" rel="noopener noreferrer">has been exploited</a> in the past by a Google engineer to find an XSS in Facebook! ðŸ™‚ However the technique required the state of the random generator to be shared between cross-domain tabs which is not the case anymore.<br/>
The third solution is to load an iframe controlled by the attacker in the hierarchy of frames in the Gmail tab. Because of the way cross-domain redirection of iframes works in the browser, the fact that Gmail X-Frame-Options header is &#8220;SAMEORIGIN&#8221; and that the messages were sent with the argument targetOrigin &#8220;*&#8221;, it would then be possible to intercept the channel name and execute the XSS.</p>
<h3>Conclusion</h3>
<p>I couldn&#8217;t find an easy way to load an iframe inside Gmail, but with all this I was confident enough to send a report to Google VRP and after a few days I received the &#8220;Nice Catch&#8221; answer and reward. Google fixed it by adding check on the origin of the message containing the url. The XSS doesn&#8217;t work anymore, but the message is still sent if you want to check.</p>
<p>Browsers have all the cool features to navigate complex code, and for the features that are still missing, you can build you own extensions easily. With that, good hunting! ðŸ™‚</p>
<p>&nbsp;</p>
<div id="xsbf-after-content" class="after-content">

<div class="twitter-share"><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fopnsec.com%2F2020%2F05%2Fdom-xss-in-gmail-with-a-little-help-from-chrome%2F&#038;via=opnsec" class="twitter-share-button">Tweet</a></div>
</div><!-- .after-content -->		
		

	<footer class="entry-meta">

					 
							<span class="cat-links"><span class="glyphicon glyphicon-tag"></span>&nbsp;
				<a href="/category/google/" rel="category tag">Google</a>				</span>
					
		 

				
	</footer><!-- .entry-meta -->



		
		
	</div><!-- .entry-content -->

</article><!-- #post-## -->

			
<div id="comments" class="comments-area">

	
			<h2 class="comments-title">
			8 comments on &ldquo;<span>DOM XSS in Gmail with a little help from Chrome</span>&rdquo;		</h2>

		
		<ul class="comment-list">
			
	<li id="comment-44522" class="comment even thread-even depth-1">
		<article id="div-comment-44522" class="comment-body">
			<footer class="comment-meta">
				<div class="comment-author vcard">
					<img alt='' src='https://secure.gravatar.com/avatar/20f05a9e6d9a4d71422818aac9bf4fe8?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/20f05a9e6d9a4d71422818aac9bf4fe8?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 thumbnail photo' height='60' width='60' loading='lazy'/>					<cite class="fn">Sergio</cite> <span class="says">says:</span>				</div><!-- .comment-author -->

				<div class="comment-metadata">
					<a href="/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-44522">
						<time datetime="2020-05-04T04:07:25+00:00">
							May 4, 2020 at 4:07 am						</time>
					</a>
									</div><!-- .comment-metadata -->

							</footer><!-- .comment-meta -->

			<div class="comment-content">
				<p>Really appreciated how clear you explained all the steps. Congrats!</p>
			</div><!-- .comment-content -->

					</article><!-- .comment-body -->

	</li><!-- #comment-## -->

	<li id="comment-45104" class="comment odd alt thread-odd thread-alt depth-1">
		<article id="div-comment-45104" class="comment-body">
			<footer class="comment-meta">
				<div class="comment-author vcard">
					<img alt='' src='https://secure.gravatar.com/avatar/e5458e9d2bdcebe941445865776894f5?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/e5458e9d2bdcebe941445865776894f5?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 thumbnail photo' height='60' width='60' loading='lazy'/>					<cite class="fn"><a href='https://WHOISbinit.me/' rel='external nofollow ugc' class='url'>Binit Ghimire</a></cite> <span class="says">says:</span>				</div><!-- .comment-author -->

				<div class="comment-metadata">
					<a href="/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-45104">
						<time datetime="2020-05-06T04:59:39+00:00">
							May 6, 2020 at 4:59 am						</time>
					</a>
									</div><!-- .comment-metadata -->

							</footer><!-- .comment-meta -->

			<div class="comment-content">
				<p>This is really an AWESOME research! Thank you for sharing, and congratulations!</p>
			</div><!-- .comment-content -->

					</article><!-- .comment-body -->

	</li><!-- #comment-## -->

	<li id="comment-45501" class="comment even thread-even depth-1 parent">
		<article id="div-comment-45501" class="comment-body">
			<footer class="comment-meta">
				<div class="comment-author vcard">
					<img alt='' src='https://secure.gravatar.com/avatar/eb2234fc2b75f8567ab67a00fca29036?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/eb2234fc2b75f8567ab67a00fca29036?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 thumbnail photo' height='60' width='60' loading='lazy'/>					<cite class="fn">JCVD</cite> <span class="says">says:</span>				</div><!-- .comment-author -->

				<div class="comment-metadata">
					<a href="/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-45501">
						<time datetime="2020-05-07T18:36:25+00:00">
							May 7, 2020 at 6:36 pm						</time>
					</a>
									</div><!-- .comment-metadata -->

							</footer><!-- .comment-meta -->

			<div class="comment-content">
				<p>Could it be possible to apply the same technique with the others messages if the page doesn&#8217;t check the origin?</p>
			</div><!-- .comment-content -->

					</article><!-- .comment-body -->

	<ul class="children">

	<li id="comment-45513" class="comment byuser comment-author-opnsec bypostauthor odd alt depth-2">
		<article id="div-comment-45513" class="comment-body">
			<footer class="comment-meta">
				<div class="comment-author vcard">
					<img alt='' src='https://secure.gravatar.com/avatar/ad925bdf7fba0f9608daa94bb809531a?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ad925bdf7fba0f9608daa94bb809531a?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 thumbnail photo' height='60' width='60' loading='lazy'/>					<cite class="fn"><a href='' rel='external nofollow ugc' class='url'>Engue Gillier</a></cite> <span class="says">says:</span>				</div><!-- .comment-author -->

				<div class="comment-metadata">
					<a href="/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-45513">
						<time datetime="2020-05-07T19:21:48+00:00">
							May 7, 2020 at 7:21 pm						</time>
					</a>
									</div><!-- .comment-metadata -->

							</footer><!-- .comment-meta -->

			<div class="comment-content">
				<p>Thx all! Yes I encourage you to check other messages on Gmail and on other websites. In this example the workflow is simple: the message contains a url that is loaded as iframe src, without url sanitation nor origin check.<br/>
In other cases the workflow might be way more complex: message encoding, partial sanitation, complex payload,  etc&#8230;<br/>
For example, what if google.com trusts *.doubleclick.net? ðŸ™‚</p>
			</div><!-- .comment-content -->

					</article><!-- .comment-body -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

	<li id="comment-46019" class="comment even thread-odd thread-alt depth-1">
		<article id="div-comment-46019" class="comment-body">
			<footer class="comment-meta">
				<div class="comment-author vcard">
					<img alt='' src='https://secure.gravatar.com/avatar/ddb4eb3f845e55c48dfece80a90d5e3f?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ddb4eb3f845e55c48dfece80a90d5e3f?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 thumbnail photo' height='60' width='60' loading='lazy'/>					<cite class="fn">Nani</cite> <span class="says">says:</span>				</div><!-- .comment-author -->

				<div class="comment-metadata">
					<a href="/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-46019">
						<time datetime="2020-05-09T16:53:20+00:00">
							May 9, 2020 at 4:53 pm						</time>
					</a>
									</div><!-- .comment-metadata -->

							</footer><!-- .comment-meta -->

			<div class="comment-content">
				<p>could u do exploit on url only? or any other parameters?</p>
			</div><!-- .comment-content -->

					</article><!-- .comment-body -->

	</li><!-- #comment-## -->

	<li id="comment-46910" class="comment odd alt thread-even depth-1">
		<article id="div-comment-46910" class="comment-body">
			<footer class="comment-meta">
				<div class="comment-author vcard">
					<img alt='' src='https://secure.gravatar.com/avatar/9e42410cda4ab6e378c21d23baa2e00e?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/9e42410cda4ab6e378c21d23baa2e00e?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 thumbnail photo' height='60' width='60' loading='lazy'/>					<cite class="fn">Just a nOob</cite> <span class="says">says:</span>				</div><!-- .comment-author -->

				<div class="comment-metadata">
					<a href="/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-46910">
						<time datetime="2020-05-13T22:55:11+00:00">
							May 13, 2020 at 10:55 pm						</time>
					</a>
									</div><!-- .comment-metadata -->

							</footer><!-- .comment-meta -->

			<div class="comment-content">
				<p>Thanks for sharing! I really believe that the Dev tools its really a great tool to hack, we just need to know how to dominate this tool! Congrats for the achievement men! I already trying to read Google source code and I it was like WOW! The way how they randomly create the functions and vars and other code its mind blowing! So I really admire what u did! Keep Up!!</p>
			</div><!-- .comment-content -->

					</article><!-- .comment-body -->

	</li><!-- #comment-## -->

	<li id="comment-47020" class="comment even thread-odd thread-alt depth-1 parent">
		<article id="div-comment-47020" class="comment-body">
			<footer class="comment-meta">
				<div class="comment-author vcard">
					<img alt='' src='https://secure.gravatar.com/avatar/dc44c0a7569b1aba3386b5046ac4069c?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/dc44c0a7569b1aba3386b5046ac4069c?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 thumbnail photo' height='60' width='60' loading='lazy'/>					<cite class="fn">vahhitiu</cite> <span class="says">says:</span>				</div><!-- .comment-author -->

				<div class="comment-metadata">
					<a href="/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-47020">
						<time datetime="2020-05-14T09:03:15+00:00">
							May 14, 2020 at 9:03 am						</time>
					</a>
									</div><!-- .comment-metadata -->

							</footer><!-- .comment-meta -->

			<div class="comment-content">
				<p>Great write up.But I don&#8217;t really understand how you get this random prefix.I just saw that you introduced two ways to get this random channel code, one is to crack math.random(), and you said that this method is not suitable for this scenario, and the other is to load a self-controlled iframe in gmail Tab, and in the next paragraph you said you didn&#8217;t find an easy way to load it.Could you tell me more clearly how to get this random prefix?</p>
			</div><!-- .comment-content -->

					</article><!-- .comment-body -->

	<ul class="children">

	<li id="comment-48064" class="comment byuser comment-author-opnsec bypostauthor odd alt depth-2">
		<article id="div-comment-48064" class="comment-body">
			<footer class="comment-meta">
				<div class="comment-author vcard">
					<img alt='' src='https://secure.gravatar.com/avatar/ad925bdf7fba0f9608daa94bb809531a?s=60&#038;d=mm&#038;r=g' srcset='https://secure.gravatar.com/avatar/ad925bdf7fba0f9608daa94bb809531a?s=120&#038;d=mm&#038;r=g 2x' class='avatar avatar-60 thumbnail photo' height='60' width='60' loading='lazy'/>					<cite class="fn"><a href='' rel='external nofollow ugc' class='url'>Engue Gillier</a></cite> <span class="says">says:</span>				</div><!-- .comment-author -->

				<div class="comment-metadata">
					<a href="/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-48064">
						<time datetime="2020-05-18T19:05:31+00:00">
							May 18, 2020 at 7:05 pm						</time>
					</a>
									</div><!-- .comment-metadata -->

							</footer><!-- .comment-meta -->

			<div class="comment-content">
				<p>Good question, I didn&#8217;t find a straight way to predict this random prefix!<br/>
I found ways to load an arbitrary iframe in Gmail but it requires user interaction so it&#8217;s not practical.<br/>
I reported the vulnerability to Google with a PoC where the Google engineer had to manually copy and paste the random prefix in an input to trigger the XSS. Google VRP validated the bug, maybe because a non secure random generator is not a proper security defense mechanism, so you have to suppose an attacker can predict the value.</p>
			</div><!-- .comment-content -->

					</article><!-- .comment-body -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
		</ul><!-- .comment-list -->

		
	
			<p class="no-comments">Comments are closed.</p>
	
	
</div><!-- #comments -->

		
		</main><!-- #main -->
	</div><!-- #primary -->

	<div id="secondary" class="widget-area col-md-4" role="complementary">
				<aside id="recent-posts-2" class="widget clearfix widget_recent_entries">
		<h2 class="widget-title">Recent Posts</h2>
		<ul>
											<li>
					<a href="/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/" aria-current="page">DOM XSS in Gmail with a little help from Chrome</a>
									</li>
											<li>
					<a href="/2018/07/into-the-borg-ssrf-inside-google-production-network/">Into the Borg &#8211; SSRF inside Google production network</a>
									</li>
											<li>
					<a href="/2018/03/stored-xss-on-facebook/">Stored XSS on Facebook</a>
									</li>
											<li>
					<a href="/2017/10/flashme-wordpress-vulnerability-disclosure-cve-2016-9263/">FlashME! &#8211; WordPress vulnerability disclosure [CVE-2016-9263]</a>
									</li>
											<li>
					<a href="/2017/10/cve-2016-9263-unpatched-xsf-vulnerability-in-wordpress/">[CVE-2016-9263] XSF vulnerability in WordPress [UPDATED]</a>
									</li>
					</ul>

		</aside><aside id="recent-comments-2" class="widget clearfix widget_recent_comments"><h2 class="widget-title">Recent Comments</h2><ul id="recentcomments"><li class="recentcomments"><span class="comment-author-link"><a href='' rel='external nofollow ugc' class='url'>Engue Gillier</a></span> on <a href="/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-48064">DOM XSS in Gmail with a little help from Chrome</a></li><li class="recentcomments"><span class="comment-author-link">vahhitiu</span> on <a href="/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-47020">DOM XSS in Gmail with a little help from Chrome</a></li><li class="recentcomments"><span class="comment-author-link">Just a nOob</span> on <a href="/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-46910">DOM XSS in Gmail with a little help from Chrome</a></li><li class="recentcomments"><span class="comment-author-link">Nani</span> on <a href="/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-46019">DOM XSS in Gmail with a little help from Chrome</a></li><li class="recentcomments"><span class="comment-author-link"><a href='' rel='external nofollow ugc' class='url'>Engue Gillier</a></span> on <a href="/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-45513">DOM XSS in Gmail with a little help from Chrome</a></li></ul></aside>	</div><!-- #secondary -->
</div><!-- .row -->
</div><!-- .container -->

	</div><!-- #content -->

	
	<div id="sidebar-pagebottom" class="sidebar-pagebottom">
				<aside id="block-4" class="widget widget_block clearfix"><div class="container">
<div class="wp-container-1 wp-block-buttons"></div>
</div><!-- container --></aside>	</div><!-- .sidebar-pagebottom -->


		<footer id="colophon" class="site-footer" role="contentinfo">
		
	

	
	
		  
	<div class="after-footer">
	<div class="container">

					<div class="footer-nav-menu pull-left">
			<nav id="footer-navigation" class="secondary-navigation" role="navigation">
				<h1 class="menu-toggle sr-only">Footer Menu</h1>
				
		<div class="sample-menu-footer-container">
		<ul id="sample-menu-footer" class="list-inline dividers">
		<li id="menu-item-sample-1" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-sample-1"><a class="smoothscroll" title="Back to top of page" href="#page"><span class="fa fa-angle-up"></span> Top</a></li><li id="menu-item-sample-2" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-sample-2"><a title="Home" href="">Home</a></li>
		</ul>
		</div>			</nav>
			</div><!-- .footer-nav-menu -->
		
					<div id="site-credits" class="site-credits pull-right">
			<span class="credits-copyright">&copy; 2026 <a href="/" rel="home">OpnSec</a>. </span><span class="credits-theme">Theme by <a href="http://xtremelysocial.com/wordpress/flat/" rel="profile" target="_blank">XtremelySocial</a>.</span>			</div><!-- .site-credits -->
		
	</div><!-- .container -->
	</div><!-- .after-footer -->
			
	</footer><!-- #colophon -->

</div><!-- #page -->

<style>.wp-container-1{display:flex;gap:.5em;flex-wrap:wrap;align-items:center}.wp-container-1>*{margin:0}</style>
<link rel='stylesheet' id='hljstheme-css' href='//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/agate.min.css?ver=0.6.2' type='text/css' media='all'/>
<script type='text/javascript' src='/wp-content/themes/flat-bootstrap/bootstrap/js/bootstrap.min.js?ver=3.3.6' id='bootstrap-js'></script>
<script type='text/javascript' src='/wp-content/themes/flat-bootstrap/js/theme.js?ver=20160303' id='theme-js'></script>
<script type='text/javascript' src='//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js?ver=0.6.2' id='hljs-js'></script>
<script type='text/javascript' id='twitter-wjs-js-extra'>//<![CDATA[
window.twttr=(function(w){t=w.twttr||{};t._e=[];t.ready=function(f){t._e.push(f);};return t;}(window));
//]]></script>
<script type="text/javascript" id="twitter-wjs" async defer src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
    <style>code.hljs{}</style>
    <script type="text/javascript">(function($,window){var init_fn_flag=false;var init_fn=(function(){if(init_fn_flag)return;init_fn_flag=true;hljs.configure({"tabReplace":"    ","useBR":true});$('pre code').each(function(i,block){hljs.highlightBlock(block);});});$(document).ready(init_fn);$(window).on("load",init_fn);})(jQuery,window);</script>
<script type='text/javascript' src='https://stats.wp.com/e-202608.js' async='async' defer='defer'></script>
<script type='text/javascript'>_stq=window._stq||[];_stq.push(['view',{v:'ext',j:'1:8.5.3',blog:'250189475',post:'382',tz:'0',srv:'opnsec.com'}]);_stq.push(['clickTrackerInit','250189475','382']);</script>

</body>
</html>