<!DOCTYPE html>
<html lang="en-US" prefix="og: https://ogp.me/ns#">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="/xmlrpc.php">

<title>Advanced Flash Vulnerabilities in Youtube – Part 3 | OpnSec</title>
<meta name='robots' content='max-image-preview:large'/>

<!-- All In One SEO Pack 3.6.2[280,358] -->
<script type="application/ld+json" class="aioseop-schema">{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"/#organization","url":"/","name":"OpnSec","sameAs":[]},{"@type":"WebSite","@id":"/#website","url":"/","name":"OpnSec","publisher":{"@id":"/#organization"},"potentialAction":{"@type":"SearchAction","target":"/?s={search_term_string}","query-input":"required name=search_term_string"}},{"@type":"WebPage","@id":"/2017/08/advanced-flash-vulnerabilities-in-youtube-part-3/#webpage","url":"/2017/08/advanced-flash-vulnerabilities-in-youtube-part-3/","inLanguage":"en-US","name":"Advanced Flash Vulnerabilities in Youtube - Part 3","isPartOf":{"@id":"/#website"},"breadcrumb":{"@id":"/2017/08/advanced-flash-vulnerabilities-in-youtube-part-3/#breadcrumblist"},"datePublished":"2017-08-30T12:04:52+00:00","dateModified":"2021-07-30T20:07:09+00:00"},{"@type":"Article","@id":"/2017/08/advanced-flash-vulnerabilities-in-youtube-part-3/#article","isPartOf":{"@id":"/2017/08/advanced-flash-vulnerabilities-in-youtube-part-3/#webpage"},"author":{"@id":"/author/opnsec/#author"},"headline":"Advanced Flash Vulnerabilities in Youtube &#8211; Part 3","datePublished":"2017-08-30T12:04:52+00:00","dateModified":"2021-07-30T20:07:09+00:00","commentCount":0,"mainEntityOfPage":{"@id":"/2017/08/advanced-flash-vulnerabilities-in-youtube-part-3/#webpage"},"publisher":{"@id":"/#organization"},"articleSection":"Flash, Flash, Vulnerability, Youtube"},{"@type":"Person","@id":"/author/opnsec/#author","name":"Engue Gillier","sameAs":[],"image":{"@type":"ImageObject","@id":"/#personlogo","url":"https://secure.gravatar.com/avatar/ad925bdf7fba0f9608daa94bb809531a?s=96&d=mm&r=g","width":96,"height":96,"caption":"Engue Gillier"}},{"@type":"BreadcrumbList","@id":"/2017/08/advanced-flash-vulnerabilities-in-youtube-part-3/#breadcrumblist","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"/","url":"/","name":"OpnSec"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"/2017/08/advanced-flash-vulnerabilities-in-youtube-part-3/","url":"/2017/08/advanced-flash-vulnerabilities-in-youtube-part-3/","name":"Advanced Flash Vulnerabilities in Youtube - Part 3"}}]}]}</script>
<link rel="canonical" href="/2017/08/advanced-flash-vulnerabilities-in-youtube-part-3/"/>
<meta property="og:type" content="article"/>
<meta property="og:title" content="Advanced Flash Vulnerabilities in Youtube – Part 3 | OpnSec"/>
<meta property="og:description" content="III. XSF via loaderinfo.url redefinition Let&#039;s have a look at how the Main App loads the Modules : The url of the module is dynamically generated by the main app by using it&#039;s own url (2) an"/>
<meta property="og:url" content="/2017/08/advanced-flash-vulnerabilities-in-youtube-part-3/"/>
<meta property="og:site_name" content="OpnSec"/>
<meta property="og:image" content="/wp-content/uploads/2017/08/s.ytimg_.com-POC-300x121.png"/>
<meta property="article:published_time" content="2017-08-30T12:04:52Z"/>
<meta property="article:modified_time" content="2021-07-30T20:07:09Z"/>
<meta property="og:image:secure_url" content="/wp-content/uploads/2017/08/s.ytimg_.com-POC-300x121.png"/>
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:site" content="@opnsec.com"/>
<meta name="twitter:title" content="Advanced Flash Vulnerabilities in Youtube – Part 3 | OpnSec"/>
<meta name="twitter:description" content="III. XSF via loaderinfo.url redefinition Let&#039;s have a look at how the Main App loads the Modules : The url of the module is dynamically generated by the main app by using it&#039;s own url (2) an"/>
<meta name="twitter:image" content="/wp-content/uploads/2017/08/s.ytimg_.com-POC-300x121.png"/>
<!-- All In One SEO Pack -->
<link rel='dns-prefetch' href='//fonts.googleapis.com'/>
<link rel='dns-prefetch' href='//s.w.org'/>
<link rel="alternate" type="application/rss+xml" title="OpnSec &raquo; Feed" href="/feed/"/>
<link rel="alternate" type="application/rss+xml" title="OpnSec &raquo; Comments Feed" href="/comments/feed/"/>
<!-- This site uses the Google Analytics by ExactMetrics plugin v6.0.2 - Using Analytics tracking - https://www.exactmetrics.com/ -->
<script type="text/javascript" data-cfasync="false">var em_version='6.0.2';var em_track_user=true;var em_no_track_reason='';var disableStr='ga-disable-UA-108066765-1';function __gaTrackerIsOptedOut(){return document.cookie.indexOf(disableStr+'=true')>-1;}if(__gaTrackerIsOptedOut()){window[disableStr]=true;}function __gaTrackerOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';window[disableStr]=true;}if('undefined'===typeof gaOptout){function gaOptout(){__gaTrackerOptout();}}if(em_track_user){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','__gaTracker');window.ga=__gaTracker;__gaTracker('create','UA-108066765-1','auto');__gaTracker('set','forceSSL',true);__gaTracker('send','pageview');__gaTracker(function(){window.ga=__gaTracker;});}else{console.log("");(function(){var noopfn=function(){return null;};var noopnullfn=function(){return null;};var Tracker=function(){return null;};var p=Tracker.prototype;p.get=noopfn;p.set=noopfn;p.send=noopfn;var __gaTracker=function(){var len=arguments.length;if(len===0){return;}var f=arguments[len-1];if(typeof f!=='object'||f===null||typeof f.hitCallback!=='function'){console.log('Not running function __gaTracker('+arguments[0]+" ....) because you are not being tracked. "+em_no_track_reason);return;}try{f.hitCallback();}catch(ex){}};__gaTracker.create=function(){return new Tracker();};__gaTracker.getByName=noopnullfn;__gaTracker.getAll=function(){return[];};__gaTracker.remove=noopfn;window['__gaTracker']=__gaTracker;window.ga=__gaTracker;})();}</script>
<!-- / Google Analytics by ExactMetrics -->
<script type="text/javascript">window._wpemojiSettings={"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/14.0.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/opnsec.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.0.11"}};!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode,e=(p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0),i.toDataURL());return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([129777,127995,8205,129778,127999],[129777,127995,8203,129778,127999])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(e=t.source||{}).concatemoji?c(e.concatemoji):e.wpemoji&&e.twemoji&&(c(e.twemoji),c(e.wpemoji)))}(window,document,window._wpemojiSettings);</script>
<style type="text/css">img.wp-smiley,img.emoji{display:inline!important;border:none!important;box-shadow:none!important;height:1em!important;width:1em!important;margin:0 .07em!important;vertical-align:-.1em!important;background:none!important;padding:0!important}</style>
	<link rel='stylesheet' id='wp-block-library-css' href='/wp-includes/css/dist/block-library/style.min.css?ver=6.0.11' type='text/css' media='all'/>
<style id='wp-block-library-inline-css' type='text/css'>.has-text-align-justify{text-align:justify}</style>
<style id='global-styles-inline-css' type='text/css'>body{--wp--preset--color--black:#000;--wp--preset--color--cyan-bluish-gray:#abb8c3;--wp--preset--color--white:#fff;--wp--preset--color--pale-pink:#f78da7;--wp--preset--color--vivid-red:#cf2e2e;--wp--preset--color--luminous-vivid-orange:#ff6900;--wp--preset--color--luminous-vivid-amber:#fcb900;--wp--preset--color--light-green-cyan:#7bdcb5;--wp--preset--color--vivid-green-cyan:#00d084;--wp--preset--color--pale-cyan-blue:#8ed1fc;--wp--preset--color--vivid-cyan-blue:#0693e3;--wp--preset--color--vivid-purple:#9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple:linear-gradient(135deg,rgba(6,147,227,1) 0%,#9b51e0 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan:linear-gradient(135deg,#7adcb4 0%,#00d082 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange:linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red:linear-gradient(135deg,rgba(255,105,0,1) 0%,#cf2e2e 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray:linear-gradient(135deg,#eee 0%,#a9b8c3 100%);--wp--preset--gradient--cool-to-warm-spectrum:linear-gradient(135deg,#4aeadc 0%,#9778d1 20%,#cf2aba 40%,#ee2c82 60%,#fb6962 80%,#fef84c 100%);--wp--preset--gradient--blush-light-purple:linear-gradient(135deg,#ffceec 0%,#9896f0 100%);--wp--preset--gradient--blush-bordeaux:linear-gradient(135deg,#fecda5 0%,#fe2d2d 50%,#6b003e 100%);--wp--preset--gradient--luminous-dusk:linear-gradient(135deg,#ffcb70 0%,#c751c0 50%,#4158d0 100%);--wp--preset--gradient--pale-ocean:linear-gradient(135deg,#fff5cb 0%,#b6e3d4 50%,#33a7b5 100%);--wp--preset--gradient--electric-grass:linear-gradient(135deg,#caf880 0%,#71ce7e 100%);--wp--preset--gradient--midnight:linear-gradient(135deg,#020381 0%,#2874fc 100%);--wp--preset--duotone--dark-grayscale:url(#wp-duotone-dark-grayscale);--wp--preset--duotone--grayscale:url(#wp-duotone-grayscale);--wp--preset--duotone--purple-yellow:url(#wp-duotone-purple-yellow);--wp--preset--duotone--blue-red:url(#wp-duotone-blue-red);--wp--preset--duotone--midnight:url(#wp-duotone-midnight);--wp--preset--duotone--magenta-yellow:url(#wp-duotone-magenta-yellow);--wp--preset--duotone--purple-green:url(#wp-duotone-purple-green);--wp--preset--duotone--blue-orange:url(#wp-duotone-blue-orange);--wp--preset--font-size--small:13px;--wp--preset--font-size--medium:20px;--wp--preset--font-size--large:36px;--wp--preset--font-size--x-large:42px}.has-black-color{color:var(--wp--preset--color--black)!important}.has-cyan-bluish-gray-color{color:var(--wp--preset--color--cyan-bluish-gray)!important}.has-white-color{color:var(--wp--preset--color--white)!important}.has-pale-pink-color{color:var(--wp--preset--color--pale-pink)!important}.has-vivid-red-color{color:var(--wp--preset--color--vivid-red)!important}.has-luminous-vivid-orange-color{color:var(--wp--preset--color--luminous-vivid-orange)!important}.has-luminous-vivid-amber-color{color:var(--wp--preset--color--luminous-vivid-amber)!important}.has-light-green-cyan-color{color:var(--wp--preset--color--light-green-cyan)!important}.has-vivid-green-cyan-color{color:var(--wp--preset--color--vivid-green-cyan)!important}.has-pale-cyan-blue-color{color:var(--wp--preset--color--pale-cyan-blue)!important}.has-vivid-cyan-blue-color{color:var(--wp--preset--color--vivid-cyan-blue)!important}.has-vivid-purple-color{color:var(--wp--preset--color--vivid-purple)!important}.has-black-background-color{background-color:var(--wp--preset--color--black)!important}.has-cyan-bluish-gray-background-color{background-color:var(--wp--preset--color--cyan-bluish-gray)!important}.has-white-background-color{background-color:var(--wp--preset--color--white)!important}.has-pale-pink-background-color{background-color:var(--wp--preset--color--pale-pink)!important}.has-vivid-red-background-color{background-color:var(--wp--preset--color--vivid-red)!important}.has-luminous-vivid-orange-background-color{background-color:var(--wp--preset--color--luminous-vivid-orange)!important}.has-luminous-vivid-amber-background-color{background-color:var(--wp--preset--color--luminous-vivid-amber)!important}.has-light-green-cyan-background-color{background-color:var(--wp--preset--color--light-green-cyan)!important}.has-vivid-green-cyan-background-color{background-color:var(--wp--preset--color--vivid-green-cyan)!important}.has-pale-cyan-blue-background-color{background-color:var(--wp--preset--color--pale-cyan-blue)!important}.has-vivid-cyan-blue-background-color{background-color:var(--wp--preset--color--vivid-cyan-blue)!important}.has-vivid-purple-background-color{background-color:var(--wp--preset--color--vivid-purple)!important}.has-black-border-color{border-color:var(--wp--preset--color--black)!important}.has-cyan-bluish-gray-border-color{border-color:var(--wp--preset--color--cyan-bluish-gray)!important}.has-white-border-color{border-color:var(--wp--preset--color--white)!important}.has-pale-pink-border-color{border-color:var(--wp--preset--color--pale-pink)!important}.has-vivid-red-border-color{border-color:var(--wp--preset--color--vivid-red)!important}.has-luminous-vivid-orange-border-color{border-color:var(--wp--preset--color--luminous-vivid-orange)!important}.has-luminous-vivid-amber-border-color{border-color:var(--wp--preset--color--luminous-vivid-amber)!important}.has-light-green-cyan-border-color{border-color:var(--wp--preset--color--light-green-cyan)!important}.has-vivid-green-cyan-border-color{border-color:var(--wp--preset--color--vivid-green-cyan)!important}.has-pale-cyan-blue-border-color{border-color:var(--wp--preset--color--pale-cyan-blue)!important}.has-vivid-cyan-blue-border-color{border-color:var(--wp--preset--color--vivid-cyan-blue)!important}.has-vivid-purple-border-color{border-color:var(--wp--preset--color--vivid-purple)!important}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background:var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple)!important}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background:var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan)!important}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background:var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange)!important}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background:var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red)!important}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background:var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray)!important}.has-cool-to-warm-spectrum-gradient-background{background:var(--wp--preset--gradient--cool-to-warm-spectrum)!important}.has-blush-light-purple-gradient-background{background:var(--wp--preset--gradient--blush-light-purple)!important}.has-blush-bordeaux-gradient-background{background:var(--wp--preset--gradient--blush-bordeaux)!important}.has-luminous-dusk-gradient-background{background:var(--wp--preset--gradient--luminous-dusk)!important}.has-pale-ocean-gradient-background{background:var(--wp--preset--gradient--pale-ocean)!important}.has-electric-grass-gradient-background{background:var(--wp--preset--gradient--electric-grass)!important}.has-midnight-gradient-background{background:var(--wp--preset--gradient--midnight)!important}.has-small-font-size{font-size:var(--wp--preset--font-size--small)!important}.has-medium-font-size{font-size:var(--wp--preset--font-size--medium)!important}.has-large-font-size{font-size:var(--wp--preset--font-size--large)!important}.has-x-large-font-size{font-size:var(--wp--preset--font-size--x-large)!important}</style>
<link rel='stylesheet' id='google_fonts-css' href='//fonts.googleapis.com/css?family=Lato:300,400,700|Raleway:400,300,700' type='text/css' media='all'/>
<link rel='stylesheet' id='font-awesome-css' href='/wp-content/themes/flat-bootstrap/font-awesome/css/font-awesome.min.css?ver=4.5.0' type='text/css' media='all'/>
<link rel='stylesheet' id='bootstrap-css' href='/wp-content/themes/flat-bootstrap/bootstrap/css/bootstrap.min.css?ver=3.3.6' type='text/css' media='all'/>
<link rel='stylesheet' id='theme-base-css' href='/wp-content/themes/flat-bootstrap/css/theme-base.css?ver=20160323' type='text/css' media='all'/>
<link rel='stylesheet' id='theme-flat-css' href='/wp-content/themes/flat-bootstrap/css/theme-flat.css?ver=20160323' type='text/css' media='all'/>
<link rel='stylesheet' id='flat-bootstrap-css' href='/wp-content/themes/flat-bootstrap/style.css?ver=6.0.11' type='text/css' media='all'/>
<link rel='stylesheet' id='jetpack_css-css' href='/wp-content/plugins/jetpack/css/jetpack.css?ver=8.5.3' type='text/css' media='all'/>
<script type='text/javascript' id='exactmetrics-frontend-script-js-extra'>//<![CDATA[
var exactmetrics_frontend={"js_events_tracking":"true","download_extensions":"zip,mp3,mpeg,pdf,docx,pptx,xlsx,rar","inbound_paths":"[{\"path\":\"\\\/go\\\/\",\"label\":\"affiliate\"},{\"path\":\"\\\/recommend\\\/\",\"label\":\"affiliate\"}]","home_url":"https:\/\/opnsec.com","hash_tracking":"false"};
//]]></script>
<script type='text/javascript' src='/wp-content/plugins/google-analytics-dashboard-for-wp/assets/js/frontend.min.js?ver=6.0.2' id='exactmetrics-frontend-script-js'></script>
<script type='text/javascript' src='/wp-includes/js/jquery/jquery.min.js?ver=3.6.0' id='jquery-core-js'></script>
<script type='text/javascript' src='/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'></script>
<link rel="https://api.w.org/" href="/wp-json/"/><link rel="alternate" type="application/json" href="/wp-json/wp/v2/posts/64"/><link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd"/>
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="/wp-includes/wlwmanifest.xml"/> 
<meta name="generator" content="WordPress 6.0.11"/>
<link rel='shortlink' href='/?p=64'/>
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fopnsec.com%2F2017%2F08%2Fadvanced-flash-vulnerabilities-in-youtube-part-3%2F"/>
<link rel="alternate" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fopnsec.com%2F2017%2F08%2Fadvanced-flash-vulnerabilities-in-youtube-part-3%2F&#038;format=xml"/>
<style>.post-thumbnail img[src$=".svg"]{width:100%;height:auto}</style><style type='text/css'>img#wpstats{display:none}</style><style type="text/css">.recentcomments a{display:inline!important;padding:0!important;margin:0!important}</style>	<style type="text/css">.site-title a,.site-description{color:#16a085}.site-title a:hover,.site-title a:active,.site-title a:focus{opacity:.75}.navbar-brand{position:absolute;clip:rect(1px,1px,1px,1px)}</style>
	<meta name="twitter:widgets:link-color" content="#000000"><meta name="twitter:widgets:border-color" content="#000000"><meta name="twitter:partner" content="tfwp"><link rel="icon" href="/wp-content/uploads/2017/08/cropped-opnsec-32x32.png" sizes="32x32"/>
<link rel="icon" href="/wp-content/uploads/2017/08/cropped-opnsec-192x192.png" sizes="192x192"/>
<link rel="apple-touch-icon" href="/wp-content/uploads/2017/08/cropped-opnsec-180x180.png"/>
<meta name="msapplication-TileImage" content="/wp-content/uploads/2017/08/cropped-opnsec-270x270.png"/>


</head>

<body class="post-template-default single single-post postid-64 single-format-standard">
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-dark-grayscale"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "/><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="0 0.49803921568627"/><feFuncG type="table" tableValues="0 0.49803921568627"/><feFuncB type="table" tableValues="0 0.49803921568627"/><feFuncA type="table" tableValues="1 1"/></feComponentTransfer><feComposite in2="SourceGraphic" operator="in"/></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-grayscale"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "/><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="0 1"/><feFuncG type="table" tableValues="0 1"/><feFuncB type="table" tableValues="0 1"/><feFuncA type="table" tableValues="1 1"/></feComponentTransfer><feComposite in2="SourceGraphic" operator="in"/></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-purple-yellow"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "/><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="0.54901960784314 0.98823529411765"/><feFuncG type="table" tableValues="0 1"/><feFuncB type="table" tableValues="0.71764705882353 0.25490196078431"/><feFuncA type="table" tableValues="1 1"/></feComponentTransfer><feComposite in2="SourceGraphic" operator="in"/></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-blue-red"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "/><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="0 1"/><feFuncG type="table" tableValues="0 0.27843137254902"/><feFuncB type="table" tableValues="0.5921568627451 0.27843137254902"/><feFuncA type="table" tableValues="1 1"/></feComponentTransfer><feComposite in2="SourceGraphic" operator="in"/></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-midnight"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "/><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="0 0"/><feFuncG type="table" tableValues="0 0.64705882352941"/><feFuncB type="table" tableValues="0 1"/><feFuncA type="table" tableValues="1 1"/></feComponentTransfer><feComposite in2="SourceGraphic" operator="in"/></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-magenta-yellow"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "/><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="0.78039215686275 1"/><feFuncG type="table" tableValues="0 0.94901960784314"/><feFuncB type="table" tableValues="0.35294117647059 0.47058823529412"/><feFuncA type="table" tableValues="1 1"/></feComponentTransfer><feComposite in2="SourceGraphic" operator="in"/></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-purple-green"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "/><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="0.65098039215686 0.40392156862745"/><feFuncG type="table" tableValues="0 1"/><feFuncB type="table" tableValues="0.44705882352941 0.4"/><feFuncA type="table" tableValues="1 1"/></feComponentTransfer><feComposite in2="SourceGraphic" operator="in"/></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;"><defs><filter id="wp-duotone-blue-orange"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 "/><feComponentTransfer color-interpolation-filters="sRGB"><feFuncR type="table" tableValues="0.098039215686275 1"/><feFuncG type="table" tableValues="0 0.66274509803922"/><feFuncB type="table" tableValues="0.84705882352941 0.41960784313725"/><feFuncA type="table" tableValues="1 1"/></feComponentTransfer><feComposite in2="SourceGraphic" operator="in"/></filter></defs></svg><div id="page" class="hfeed site">

		
	<header id="masthead" class="site-header" role="banner">

					<div id="site-branding" class="site-branding">
			
							<div class="container">
                                <div class="site-branding-text">
				<h1 class="site-title"><a href="/" rel="home">OpnSec</a></h1>
				<h2 class="site-description">Open mind Security and Crypto!</h2>
				</div>
				</div>
						</div><!-- .site-branding -->

					

			
		<nav id="site-navigation" class="main-navigation" role="navigation">

			<h2 class="menu-toggle screen-reader-text sr-only ">Primary Menu</h2>
			<div class="skip-link"><a class="screen-reader-text sr-only" href="#content">Skip to content</a></div>

		<div class="navbar navbar-default navbar-static-top"><div class="container"><div class="navbar-header"><button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a class="navbar-brand" href="/" rel="home">OpnSec</a></div><!-- navbar-header --><div class="navbar-collapse collapse"><div class="menu-test-container"><ul id="menu-test" class="nav navbar-nav"><li id="menu-item-313" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-313"><a title="About Me" href="/about-me/">About Me</a></li>
</ul></div>
		</div><!-- .container -->
		</div><!-- .navbar -->
		</nav><!-- #site-navigation -->

	</header><!-- #masthead -->

		
	<div id="content" class="site-content">



			<header class="content-header">
		<div class="container">
		<h1 class="page-title">Advanced Flash Vulnerabilities in Youtube &#8211; Part 3</h1>
				</div>
		</header>

	

<a id="pagetop"></a>



<div class="container">
<div id="main-grid" class="row">

	<div id="primary" class="content-area col-md-8">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-64" class="post-64 post type-post status-publish format-standard hentry category-flash tag-flash tag-vulnerability tag-youtube">

	
<header class="entry-header">
	<div class="entry-meta">
	
		
		
						<p><span class="posted-on"><span class="glyphicon glyphicon-calendar"></span>&nbsp;
			August 30, 2017 
			</span>
	
			
		
		
				
	</div><!-- .entry-meta -->
</header><!-- .entry-header -->
	
	<div id="xsbf-entry-content" class="entry-content">
		<h3>III. XSF via loaderinfo.url redefinition</h3>
<p><img class="alignnone size-medium wp-image-150" style="display: none;" src="/wp-content/uploads/2017/08/s.ytimg_.com-POC-300x121.png" alt="" width="1" height="1" srcset="/wp-content/uploads/2017/08/s.ytimg_.com-POC-300x121.png 300w, /wp-content/uploads/2017/08/s.ytimg_.com-POC-150x150.png 150w, /wp-content/uploads/2017/08/s.ytimg_.com-POC-768x310.png 768w, /wp-content/uploads/2017/08/s.ytimg_.com-POC-1024x414.png 1024w, /wp-content/uploads/2017/08/s.ytimg_.com-POC-640x360.png 640w, /wp-content/uploads/2017/08/s.ytimg_.com-POC.png 1186w" sizes="(max-width: 1px) 100vw, 1px"/>Let&#8217;s have a look at how the Main App loads the Modules :</p>
<p><a href="/wp-content/uploads/2017/08/Diagramme7.svg"><img loading="lazy" class="wp-image-66 aligncenter" src="/wp-content/uploads/2017/08/Diagramme7.svg" alt="" width="907" height="217"/></a></p>
<p>The url of the module is dynamically generated by the main app by using it&#8217;s own url (2) and replacing the filename (watch_as3.swf) by the module filename (subtitles.swf) (3). This allows to handle multiple versions on the Main App, each one with it&#8217;s own Modules location.</p>
<p>To find it&#8217;s own url, the main app uses the <a href="http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/LoaderInfo.html#url" target="_blank" rel="noopener noreferrer">loaderinfo.url</a> property of appLoader.</p>
<blockquote><p>Since appLoader is similar to an &lt;iframe&gt; in html, appLoader.loaderInfo.url is similar to the &#8220;src&#8221; attribute of the iframe.</p></blockquote>
<p>In flash a Loader can load multiple swf files while in html an iframe can only load one window at a time</p>
<p>This means that if appLoader first loads the Main App and then immediately loads another Flash file the loaderinfo.url property of the Main app will not reflect the url of the Main App but instead the url of the other loaded flash file.<br/>
POC workflow</p>
<p><a href="/wp-content/uploads/2017/08/Diagramme5.svg"><img loading="lazy" class="wp-image-68 aligncenter" src="/wp-content/uploads/2017/08/Diagramme5.svg" alt="" width="818" height="314"/></a></p>
<p>We removed Youtube Wrapper and replaced it with Evil Wrapper. Evil Wrapper will first load the Main App (1), and then immediately load another file (Noop.swf) with the same Loader appLoader (2). When the Main app will try to load a Module, it will get the appLoader url value (3) (evil.com/Noop.swf), replace the filename with the module name (evil.com/subtitles.swf) and load an arbitrary Flash file into it own Flash security sandbox (4).</p>
<p>From there Evil Module will be in the Main App Security Sandbox and will appear to be located at s.ytimg.com/[[IMPORT]]/evil.com/subtitles.swf. However, s.ytimg.com is a sandboxed domain which doesn&#8217;t have any cookie, CSRF token or webpage to exploit.</p>
<p>In <a href="/2017/08/advanced-flash-vulnerabilities-in-youtube-part-2/">part 2</a> I introduced URLLoader, which is similar to XHR. You can make cross-domain requests with URLLoader if the remote server has a crossdomain.xml file allowing &#8220;s.ytimg.com&#8221;</p>
<blockquote><p>crossdomain.xml mechanism is similar to CORS headers for XHR cross-domain requests in javascript</p></blockquote>
<p>The good news is that <a href="https://www.youtube.com/crossdomain.xml" target="_blank" rel="noopener noreferrer">https://www.youtube.com/crossdomain.xml</a> does allow https://s.ytimg.com/. Even more, <a href="https://drive.google.com/crossdomain.xml" target="_blank" rel="noopener noreferrer">https://drive.google.com/crossdomain.xml</a>, <a href="https://docs.google.com/crossdomain.xml" target="_blank" rel="noopener noreferrer">https://docs.google.com/crossdomain.xml</a> and <a href="https://clients6.google.com/crossdomain.xml" target="_blank" rel="noopener noreferrer">other google domains </a>also allow https://s.ytimg.com/.</p>
<p>This means that Evil Module can send requests to any URL at youtube.com, drive.google.com and docs.google.com (including POST requests and custom headers) and read the response source code (5).<br/>
Attack scenario:<br/>
1. The victim is logged in Youtube or Google Drive and has Flash player<br/>
2. The victim visits the attacker evil.com/evil.html page which contains a Flash object evil.com/evil.swf<br/>
3. The attacker has control over the victim&#8217;s Youtube, Google Drive and Google Docs accounts</p>
<p>Impact:<br/>
The attacker can steal private information, CSRF tokens and perform any CSRF action on these domains. A very nasty exploit could steal and delete all the victim Google Drive files and then post the POC url on Youtube comments from the victim account to spread the exploit. I won&#8217;t provide such POC (I would like to safely return to DefCon next year&#8230;) but it would only take about 20 LOC to build it!</p>
<p>Timeline:<br/>
09/11/2015 &#8211; reported to Google VRP<br/>
09/16/2015 &#8211; &#8220;Nice catch&#8221; from Google<br/>
09/25/2015 &#8211; Temporary mitigation and reward<img loading="lazy" class="alignnone size-full wp-image-70" src="/wp-content/uploads/2017/08/3-stars.png" alt="" width="60" height="14"/><br/>
10/14/2015 &#8211; Issue fixed and verified</p>
<p>Conclusion:<br/>
When using a sandboxed domain for hosting untrusted applications, like s.ytimg.com, you should always make sure that the sandboxed domain has no privilege on sensitive domains, like crossdomain.xml files, CORS, framing or CSP.</p>
<p>[<strong>UPDATED</strong>] <strong><a href="/2017/09/advanced-flash-vulnerabilities-in-youtube-part-4/">Part 4 </a></strong>is now online with 3 Flash based XSS on Youtube!</p>
<p>You can also see a live Flash based XSS on twitter <a href="/twitter/photo.html" target="_blank" rel="noopener noreferrer">here</a></p>
<div id="xsbf-after-content" class="after-content">

<div class="twitter-share"><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fopnsec.com%2F2017%2F08%2Fadvanced-flash-vulnerabilities-in-youtube-part-3%2F&#038;via=opnsec" class="twitter-share-button">Tweet</a></div>
</div><!-- .after-content -->		
		

	<footer class="entry-meta">

					 
							<span class="cat-links"><span class="glyphicon glyphicon-tag"></span>&nbsp;
				<a href="/category/flash/" rel="category tag">Flash</a>				</span>
					
		<span class="tags-links"><span class="glyphicon glyphicon-tags"></span> &nbsp;<a href="/tag/flash/" rel="tag">Flash</a>, <a href="/tag/vulnerability/" rel="tag">Vulnerability</a>, <a href="/tag/youtube/" rel="tag">Youtube</a></span> 

				
	</footer><!-- .entry-meta -->



		
		
	</div><!-- .entry-content -->

</article><!-- #post-## -->

			
		
		</main><!-- #main -->
	</div><!-- #primary -->

	<div id="secondary" class="widget-area col-md-4" role="complementary">
				<aside id="search-2" class="widget clearfix widget_search"><form role="search" method="get" class="search-form form-inline" action="/">
<div class="form-group">
	<label>
		<span class="screen-reader-text sr-only">Search for:</span>
		<input type="search" class="search-field form-control" placeholder="Search &hellip;" value="" name="s">
	</label>
	<input type="submit" class="search-submit btn btn-primary" value="Search">
</div><!-- .form-group -->
</form>
</aside>
		<aside id="recent-posts-2" class="widget clearfix widget_recent_entries">
		<h2 class="widget-title">Recent Posts</h2>
		<ul>
											<li>
					<a href="/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/">DOM XSS in Gmail with a little help from Chrome</a>
									</li>
											<li>
					<a href="/2018/07/into-the-borg-ssrf-inside-google-production-network/">Into the Borg &#8211; SSRF inside Google production network</a>
									</li>
											<li>
					<a href="/2018/03/stored-xss-on-facebook/">Stored XSS on Facebook</a>
									</li>
											<li>
					<a href="/2017/10/flashme-wordpress-vulnerability-disclosure-cve-2016-9263/">FlashME! &#8211; WordPress vulnerability disclosure [CVE-2016-9263]</a>
									</li>
											<li>
					<a href="/2017/10/cve-2016-9263-unpatched-xsf-vulnerability-in-wordpress/">[CVE-2016-9263] XSF vulnerability in WordPress [UPDATED]</a>
									</li>
					</ul>

		</aside><aside id="recent-comments-2" class="widget clearfix widget_recent_comments"><h2 class="widget-title">Recent Comments</h2><ul id="recentcomments"><li class="recentcomments"><span class="comment-author-link"><a href='' rel='external nofollow ugc' class='url'>Engue Gillier</a></span> on <a href="/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-48064">DOM XSS in Gmail with a little help from Chrome</a></li><li class="recentcomments"><span class="comment-author-link">vahhitiu</span> on <a href="/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-47020">DOM XSS in Gmail with a little help from Chrome</a></li><li class="recentcomments"><span class="comment-author-link">Just a nOob</span> on <a href="/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-46910">DOM XSS in Gmail with a little help from Chrome</a></li><li class="recentcomments"><span class="comment-author-link">Nani</span> on <a href="/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-46019">DOM XSS in Gmail with a little help from Chrome</a></li><li class="recentcomments"><span class="comment-author-link"><a href='' rel='external nofollow ugc' class='url'>Engue Gillier</a></span> on <a href="/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-45513">DOM XSS in Gmail with a little help from Chrome</a></li></ul></aside>	</div><!-- #secondary -->
</div><!-- .row -->
</div><!-- .container -->

	</div><!-- #content -->

	
	<div id="sidebar-pagebottom" class="sidebar-pagebottom">
				<aside id="block-4" class="widget widget_block clearfix"><div class="container">
<div class="wp-container-1 wp-block-buttons"></div>
</div><!-- container --></aside>	</div><!-- .sidebar-pagebottom -->


		<footer id="colophon" class="site-footer" role="contentinfo">
		
	

	
	
		  
	<div class="after-footer">
	<div class="container">

					<div class="footer-nav-menu pull-left">
			<nav id="footer-navigation" class="secondary-navigation" role="navigation">
				<h1 class="menu-toggle sr-only">Footer Menu</h1>
				
		<div class="sample-menu-footer-container">
		<ul id="sample-menu-footer" class="list-inline dividers">
		<li id="menu-item-sample-1" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-sample-1"><a class="smoothscroll" title="Back to top of page" href="#page"><span class="fa fa-angle-up"></span> Top</a></li><li id="menu-item-sample-2" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-sample-2"><a title="Home" href="">Home</a></li>
		</ul>
		</div>			</nav>
			</div><!-- .footer-nav-menu -->
		
					<div id="site-credits" class="site-credits pull-right">
			<span class="credits-copyright">&copy; 2026 <a href="/" rel="home">OpnSec</a>. </span><span class="credits-theme">Theme by <a href="http://xtremelysocial.com/wordpress/flat/" rel="profile" target="_blank">XtremelySocial</a>.</span>			</div><!-- .site-credits -->
		
	</div><!-- .container -->
	</div><!-- .after-footer -->
			
	</footer><!-- #colophon -->

</div><!-- #page -->

<style>.wp-container-1{display:flex;gap:.5em;flex-wrap:wrap;align-items:center}.wp-container-1>*{margin:0}</style>
<link rel='stylesheet' id='hljstheme-css' href='//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/agate.min.css?ver=0.6.2' type='text/css' media='all'/>
<script type='text/javascript' src='/wp-content/themes/flat-bootstrap/bootstrap/js/bootstrap.min.js?ver=3.3.6' id='bootstrap-js'></script>
<script type='text/javascript' src='/wp-content/themes/flat-bootstrap/js/theme.js?ver=20160303' id='theme-js'></script>
<script type='text/javascript' src='//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js?ver=0.6.2' id='hljs-js'></script>
<script type='text/javascript' id='twitter-wjs-js-extra'>//<![CDATA[
window.twttr=(function(w){t=w.twttr||{};t._e=[];t.ready=function(f){t._e.push(f);};return t;}(window));
//]]></script>
<script type="text/javascript" id="twitter-wjs" async defer src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
    <style>code.hljs{}</style>
    <script type="text/javascript">(function($,window){var init_fn_flag=false;var init_fn=(function(){if(init_fn_flag)return;init_fn_flag=true;hljs.configure({"tabReplace":"    ","useBR":true});$('pre code').each(function(i,block){hljs.highlightBlock(block);});});$(document).ready(init_fn);$(window).on("load",init_fn);})(jQuery,window);</script>
<script type='text/javascript' src='https://stats.wp.com/e-202608.js' async='async' defer='defer'></script>
<script type='text/javascript'>_stq=window._stq||[];_stq.push(['view',{v:'ext',j:'1:8.5.3',blog:'250189475',post:'64',tz:'0',srv:'opnsec.com'}]);_stq.push(['clickTrackerInit','250189475','64']);</script>

</body>
</html>